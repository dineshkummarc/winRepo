COMSCORE.SiteRecruit.Utils.getPageWidth=function(){var A=0,B=document;if(typeof(window.innerWidth)=="number"){A=window.innerWidth;
}else{if(B.documentElement&&(B.documentElement.clientWidth||B.documentElement.clientHeight)){A=B.documentElement.clientWidth;
}else{if(B.body&&(B.body.clientWidth||B.body.clientHeight)){A=B.body.clientWidth;
}}}return A;};COMSCORE.SiteRecruit.Utils.getPageHeight=function(){var A=0,B=document;
if(typeof(window.innerWidth)=="number"){A=window.innerHeight;}else{if(B.documentElement&&(B.documentElement.clientWidth||B.documentElement.clientHeight)){A=B.documentElement.clientHeight;
}else{if(B.body&&(B.body.clientWidth||B.body.clientHeight)){A=B.body.clientHeight;
}}}return A;};COMSCORE.SiteRecruit.Utils.getPageTopOffset=function(){var A=0;var B=document;
if(typeof(window.pageYOffset)=="number"){A=window.pageYOffset;}else{if(B.body&&(B.body.scrollLeft||B.body.scrollTop)){A=B.body.scrollTop;
}else{if(B.documentElement&&(B.documentElement.scrollLeft||B.documentElement.scrollTop)){A=B.documentElement.scrollTop;
}}}return A;};COMSCORE.SiteRecruit.Utils.getPageLeftOffset=function(){var A=0;var B=document;
if(typeof(window.pageYOffset)=="number"){A=window.pageXOffset;}else{if(B.body&&(B.body.scrollLeft||B.body.scrollTop)){A=B.body.scrollLeft;
}else{if(B.documentElement&&(B.documentElement.scrollLeft||B.documentElement.scrollTop)){A=B.documentElement.scrollLeft;
}}}return A;};COMSCORE.SiteRecruit.Utils.openWindow=function(A,B){B=B||"";return window.open(A,"",B);
};COMSCORE.SiteRecruit.Utils.toQueryString=function(E){var A=[],D;function C(F,G){return(escape(F)+"="+(G===null?"":escape(G)));
}for(D=E.length-1;D>=0;D--){var B=E[D];A.push(C(B.n,B.v));}return A.join("&");};COMSCORE.SiteRecruit.Utils.lang={extend:function(B,D,A){if(!D||!B){return;
}var E=function(){};E.prototype=D.prototype;B.prototype=new E();B.prototype.constructor=B;
B.superclass=D.prototype;if(D.prototype.constructor==Object.prototype.constructor){D.prototype.constructor=D;
}if(A){for(var C in A){B.prototype[C]=A[C];}}}};COMSCORE.SiteRecruit.Invitation={METHODOLOGY:{STANDARD:0,EMAIL:1,DD:2,QINVITE:3},REMOVE_DELAY:{ACCEPT:500,DECLINE:200},acceptHandlerTag:"@acceptHandler",declineHandlerTag:"@declineHandler",acceptHandler:"return COMSCORE.SiteRecruit.Builder.invitation.accept(this)",declineHandler:"return COMSCORE.SiteRecruit.Builder.invitation.decline(this); return false"};
COMSCORE.SiteRecruit.Invitation.Renderer=(function(){var I;var G=0,E=0,D=0,J=0,C=0,A=0;
var F=COMSCORE.SiteRecruit;var H=F.Utils;function B(){clearInterval(I);}return{HORIZONTAL_ALIGNMENT:{LEFT:0,MIDDLE:1,RIGHT:2},VERTICAL_ALIGNMENT:{TOP:0,MIDDLE:1,BOTTOM:2},init:function(){var K=this.invitation.config;
C=K.width;A=K.height;switch(K.horizontalAlignment){case this.HORIZONTAL_ALIGNMENT.LEFT:G=K.horizontalMargin;
break;case this.HORIZONTAL_ALIGNMENT.MIDDLE:G=(H.getPageWidth()-C)/2;break;case this.HORIZONTAL_ALIGNMENT.RIGHT:G=H.getPageWidth()-C-K.horizontalMargin;
break;}switch(K.verticalAlignment){case this.VERTICAL_ALIGNMENT.TOP:E=K.verticalMargin;
break;case this.VERTICAL_ALIGNMENT.MIDDLE:E=(H.getPageHeight()-A)/2;break;case this.VERTICAL_ALIGNMENT.BOTTOM:E=H.getPageHeight()-A-K.verticalMargin;
break;}this.setPosition(G,E);},autoCenter:function(){D=Math.round(H.getPageWidth()/2)-Math.round(C/2);
J=Math.round(H.getPageHeight()/2)-Math.round(A/2);var R=5;var L=G;var M=E;var N=H.getPageLeftOffset();
var Q=H.getPageTopOffset();var P=Math.abs(N+D-L);var S=Math.abs(H.getPageTopOffset()+J-M);
var O=Math.sqrt(P*P+S*S);var K=Math.round(O/50);if(N+D>L){L=L+R+K;}if(N+D<L){L=L-R-K;
}if(Q+J>M){M=M+R+K;}if(Q+J<M){M=M-R-K;}if(this.invitation.config.isHideBlockingElements){this.hideBlockingElements(true);
}this.setPosition(L,M);G=L;E=M;},start:function(L){this.invitation=L;this.init();
L.container.style.visibility="visible";if(L.config.isAutoCentering){var K=this;I=setInterval(function(){K.autoCenter();
},5);}L.logView();},setPosition:function(K,L){var M=this.invitation.container.style;
M.left=K+"px";M.top=L+"px";},hideBlockingElements:function(L){var M=-1,N,K=[];if(!L||this.blockedElements===null){K=K.concat(document.getElementsByTagName("object"),K.concat(document.getElementsByTagName("select")));
this.blockedElements=[];}while(++M<=1){for(N=K.length-1;N>=0;N--){var O=K[M][N];if(O&&O.style&&O.style.visibility!="hidden"){O.style.visibility="hidden";
if(!L){this.blockedElements.push(O);}}}}},showBlockingElements:function(){var K=this.blockedElements,L;
if(K){for(L=K.length-1;L>=0;L--){K[L].style.visibility="visible";K.pop();}}},destroy:function(){B();
if(this.invitation.config.isHideBlockingElements){this.showBlockingElements();}var K=this.invitation.container;
K.style.visibility="hidden";function L(P){var O=P.attributes,N,Q,M;if(O){Q=O.length;
for(N=0;N<Q;N+=1){if(O[N]!=null){M=O[N].name;}if(typeof P[M]==="function"){P[M]=null;
}}}O=P.childNodes;if(O){Q=O.length;for(N=0;N<Q;N+=1){L(P.childNodes[N]);}}}L(K);K.parentNode.removeChild(K);
}};})();COMSCORE.SiteRecruit.Invitation.BaseInvitation=function(A){this.config=A;
};COMSCORE.SiteRecruit.Invitation.BaseInvitation.prototype={constructor:COMSCORE.SiteRecruit.Invitation.BaseInvitation,logView:function(){var B=COMSCORE.SiteRecruit.Utils;
if(!this.config.viewUrl){return;}var A=this.config.viewParams||"";A+="&location="+escape(COMSCORE.SiteRecruit.Utils.location)+"&referrer="+escape(document.referrer)+"&site="+COMSCORE.SiteRecruit.Builder.invitation.config.acceptParams.siteCode;
var C=B.appendQueryParams(this.config.viewUrl,A);B.fireBeacon(C);},updateContentPaths:function(){var B=COMSCORE.SiteRecruit.executingPath;
this.content=this.content.replace(/url\((.+?)\)/mig,"url("+B+"$1)");this.content=this.content.replace(/src=['"](.+?)['"]/mig,"src='"+B+"$1'");
var A=this.content.match(/\w*\.xap\s*/mi);if(A!=null){this.content=this.content.replace(/<param\s*name\s*=\s*"\s*source\s*"\s*value\s*=\s*"\s*.*.xap\s*"/mig,'<param name="source" value="'+B+A+'"');
}if(!COMSCORE.SiteRecruit.browser.ie&&!COMSCORE.SiteRecruit.browser.ie7){}},removeSilverlight:function(A){this.tempContainer=document.createElement("div");
var C=this.tempContainer;C.innerHTML=A;var G=/silverlight/mig;if(C.childNodes&&C.childNodes.length>0){for(var F=0;
F<C.childNodes.length;F++){if(C.childNodes[F].nodeName=="OBJECT"&&C.childNodes[F].getAttribute("type")&&G.test(C.childNodes[F].getAttribute("type"))){var D=C.childNodes[F];
for(var E=0,B;B=D.childNodes[E++];){if(B.nodeName!="PARAM"&&B.innerHTML){A=B;}}}}}this.tempcontainer=null;
return A;},preRender:function(){var B=COMSCORE.SiteRecruit.Invitation;var C=new RegExp(B.acceptHandlerTag,"g");
var A=new RegExp(B.declineHandlerTag,"g");this.content=this.config.content.replace(C,B.acceptHandler);
this.content=this.content.replace(A,B.declineHandler);this.updateContentPaths();},inject:function(){if(this.config.isHideBlockingElements){COMSCORE.SiteRecruit.Invitation.Renderer.hideBlockingElements();
}COMSCORE.SiteRecruit.Invitation.Renderer.start(this);},render:function(){this.preRender();
this.container=document.createElement("div");var B=this.container;if(typeof(this.content)=="string"){B.innerHTML=this.content;
}else{B.appendChild(this.content);}var A=B.style;A.position="absolute";A.left="0px";
A.top="0px";A.zIndex=10001;A.visibility="hidden";document.body.appendChild(B);this.config.revealDelay=this.config.revealDelay||1;
var C=this;setTimeout(function(){C.inject();},this.config.revealDelay);},removeInvitation:function(B){B=B||1;
var A=this;setTimeout(function(){COMSCORE.SiteRecruit.Invitation.Renderer.destroy();
},B);},decline:function(){this.removeInvitation(COMSCORE.SiteRecruit.Invitation.REMOVE_DELAY.DECLINE);
return false;},accept:function(){var B=COMSCORE.SiteRecruit.Utils;this.removeInvitation(COMSCORE.SiteRecruit.Invitation.REMOVE_DELAY.ACCEPT);
this.surveyData=COMSCORE.SiteRecruit.Builder.collectSurveyData();var D=COMSCORE.SiteRecruit.Builder.invitation.config;
var A="?log=comscore/accept/"+D.projectId+"-accept.log&location="+escape(COMSCORE.SiteRecruit.Utils.location)+"&referrer="+escape(document.referrer)+"&site="+D.acceptParams.siteCode;
var C=B.appendQueryParams(this.config.viewUrl,A);B.fireBeacon(C);},appendSurveyDataToAcceptUrl:function(C){var B=COMSCORE.SiteRecruit.Utils;
var A=B.toQueryString(this.surveyData)+"&"+this.config.acceptParams.raw;if(COMSCORE.SiteRecruit.Broker.scriptArgs){A+="&"+COMSCORE.SiteRecruit.Broker.scriptArgs;
}var E={};E.cookiename=COMSCORE.SiteRecruit.Broker.config.cookie.name;E.cookieoptions=COMSCORE.SiteRecruit.Broker.config.cookie;
var D=B.UserPersistence.getUserObj(E);if(D&&D.userid){if(D.userid){A+="&userid="+D.userid;
}if(D.surveys){A+="&surveys="+D.surveys;}if(D.vendorid){A+="&vendorid="+D.vendorid;
}}return B.appendQueryParams(C,A);}};COMSCORE.SiteRecruit.Invitation.Standard=function(A){COMSCORE.SiteRecruit.Invitation.Standard.superclass.constructor.call(this,A);
};COMSCORE.SiteRecruit.Utils.lang.extend(COMSCORE.SiteRecruit.Invitation.Standard,COMSCORE.SiteRecruit.Invitation.BaseInvitation,{accept:function(){COMSCORE.SiteRecruit.Invitation.Standard.superclass.accept.call(this);
var A={};A.cookiename=COMSCORE.SiteRecruit.Broker.config.cookie.name;A.cookieoptions=COMSCORE.SiteRecruit.Broker.config.cookie;
A.statename=COMSCORE.SiteRecruit.CONSTANTS.STATE_NAME.IDLE;A.pid=this.config.projectId;
COMSCORE.SiteRecruit.Utils.UserPersistence.setUserObj(A);var B=this.appendSurveyDataToAcceptUrl(this.config.acceptUrl);
if(COMSCORE.SiteRecruit.Silverlight){COMSCORE.SiteRecruit.Silverlight.acceptUrl=B;
COMSCORE.SiteRecruit.Silverlight.features="width=400,height=400,resizable=1,scrollbars=1,status=1";
}COMSCORE.SiteRecruit.Utils.openWindow(B,"width=400,height=400,resizable=1,scrollbars=1,status=1");
},toString:function(){return"Standard";}});COMSCORE.SiteRecruit.Invitation.Email=function(A){COMSCORE.SiteRecruit.Invitation.Email.superclass.constructor.call(this,A);
};COMSCORE.SiteRecruit.Utils.lang.extend(COMSCORE.SiteRecruit.Invitation.Email,COMSCORE.SiteRecruit.Invitation.BaseInvitation,{accept:function(){var C=document.getElementById("SiteRecruit_invitationForm");
if(C){if(!C.email.value||!COMSCORE.SiteRecruit.Builder.validateEmailAddress(C.email.value)){alert("You have entered an invalid e-mail address. Please enter a valid e-mail address to participate.");
return false;}}else{return false;}COMSCORE.SiteRecruit.Builder.addSurveyParam("email",C.email.value);
COMSCORE.SiteRecruit.Invitation.Email.superclass.accept.call(this);COMSCORE.SiteRecruit.Builder.addSurveyParam("action","register");
var A={};A.cookiename=COMSCORE.SiteRecruit.Broker.config.cookie.name;A.cookieoptions=COMSCORE.SiteRecruit.Broker.config.cookie;
A.statename=COMSCORE.SiteRecruit.CONSTANTS.STATE_NAME.IDLE;A.pid=this.config.projectId;
COMSCORE.SiteRecruit.Utils.UserPersistence.setUserObj(A);var B=this.appendSurveyDataToAcceptUrl(this.config.acceptUrl);
COMSCORE.SiteRecruit.Utils.fireBeacon(B);return true;},toString:function(){return"Email";
}});COMSCORE.SiteRecruit.Invitation.DD=function(A){COMSCORE.SiteRecruit.Invitation.DD.superclass.constructor.call(this,A);
};COMSCORE.SiteRecruit.Invitation.DD.ORIENTATION={DEFAULT:0,CENTER:1,BOTTOMCENTER:2,BOTTOMLEFT:3,BOTTOMRIGHT:4};
COMSCORE.SiteRecruit.Utils.lang.extend(COMSCORE.SiteRecruit.Invitation.DD,COMSCORE.SiteRecruit.Invitation.BaseInvitation,{accept:function(){COMSCORE.SiteRecruit.Invitation.DD.superclass.accept.call(this);
var A=COMSCORE.SiteRecruit.Builder.addSurveyParam;var C=COMSCORE.SiteRecruit.Broker.config.cookie;
var D=this.config.trackerWindow;A("surveyUrl",this.config.acceptUrl);A("cookieName",C.name);
A("cookiePath",C.path);A("cookieDomain",C.domain);A("cookieDuration",C.duration);
A("cookieDate",C.date);A("trackerPageConfigUrl",COMSCORE.SiteRecruit.executingPath+this.config.trackerWindow.trackerPageConfigUrl);
COMSCORE.SiteRecruit.DDKeepAlive.setDDTrackerCookie();var B=this.appendSurveyDataToAcceptUrl(this.config.url);
COMSCORE.SiteRecruit.Broker.processDDInProgress();if(COMSCORE.SiteRecruit.Silverlight){var E=D.features||"resizable=1,status=1,scrollbars=1";
if(D){if(D.width){E+=",width="+D.width;}else{E+=",width="+400;}if(D.height){E+=",height="+D.height;
}else{E+=",height="+270;}}COMSCORE.SiteRecruit.Silverlight.acceptUrl=COMSCORE.SiteRecruit.executingPath+B;
COMSCORE.SiteRecruit.Silverlight.features=E;}this.openWindow(COMSCORE.SiteRecruit.executingPath+B);
},openWindow:function(B){var G=this.config.trackerWindow;var F=G.features||"resizable=1,status=1,scrollbars=1";
if(G){if(G.width){F+=",width="+G.width;}else{F+=",width="+400;}if(G.height){F+=",height="+G.height;
}else{F+=",height="+270;}if(G.orientation&&G.width&&G.height){var C=self.screen.availWidth,D=self.screen.availHeight;
var E=G.offsetX||0,H=G.offsetY||0;var I,A;var J=COMSCORE.SiteRecruit.Invitation.DD.ORIENTATION;
switch(G.orientation){case J.CENTER:I=(C/2)-(G.width/2);A=(D/2)-(G.height/2);break;
case J.BOTTOMCENTER:I=(C/2)-(G.width/2);A=D-G.height;break;case J.BOTTOMLEFT:I=0;
A=D-G.height;break;case J.BOTTOMRIGHT:I=C-G.width;A=D-G.height;break;default:}if(G.orientation>0){I+=E;
A+=H;F+=",left="+I+",top="+A;}}COMSCORE.SiteRecruit.Utils.openWindow(B,F);}else{}},toString:function(){return"DD";
}});COMSCORE.SiteRecruit.Invitation.QInvite=function(A){COMSCORE.SiteRecruit.Invitation.QInvite.superclass.constructor.call(this,A);
};COMSCORE.SiteRecruit.Invitation.QInvite.tags={random:"@random",item:"@item",end:"@end"};
COMSCORE.SiteRecruit.Utils.lang.extend(COMSCORE.SiteRecruit.Invitation.QInvite,COMSCORE.SiteRecruit.Invitation.BaseInvitation,{preRender:function(){COMSCORE.SiteRecruit.Invitation.QInvite.superclass.preRender.call(this);
this.content=this.randomizeQuestions();},accept:function(){COMSCORE.SiteRecruit.Invitation.QInvite.superclass.accept.call(this);
var A={};A.cookiename=COMSCORE.SiteRecruit.Broker.config.cookie.name;A.cookieoptions=COMSCORE.SiteRecruit.Broker.config.cookie;
A.statename=COMSCORE.SiteRecruit.CONSTANTS.STATE_NAME.IDLE;A.pid=this.config.projectId;
COMSCORE.SiteRecruit.Utils.UserPersistence.setUserObj(A);var B=this.appendSurveyDataToAcceptUrl(this.config.acceptUrl);
if(COMSCORE.SiteRecruit.Silverlight){COMSCORE.SiteRecruit.Silverlight.acceptUrl=B;
COMSCORE.SiteRecruit.Silverlight.features="width=400,height=400,resizable=1,scrollbars=1";
}COMSCORE.SiteRecruit.Utils.openWindow(B,"width=400,height=400,resizable=yes,scrollbars=yes");
},randomizeQuestions:function(){var A=this.content.match(/@random.*?@endrandom/gm);
var C="CS__ITEMLIST_",D=0,G;while((G=A.pop())!=null){var B=C+D++;this.content=this.content.replace(/@random.*?@endrandom/,B);
var E=G.replace(/@random(.*?)@endrandom/m,"$1");var F=E.match(/@item.*?@enditem/gm);
F.sort(function(){return Math.random()-0.5;});while(F.length){E=E.replace(/(@item.*?@enditem)/m,F.pop().replace(/@item(.*?)@enditem/m,"$1"));
}this.content=this.content.replace(new RegExp(B),E);}return this.content;},toString:function(){return"QInvite";
}});COMSCORE.SiteRecruit.Builder=(function(){var C=COMSCORE.SiteRecruit;var B=C.Utils;
var A=C.Broker;return{version:"4.6.3",init:function(){if(C.version!==this.version){return;
}var D=C.executingPath+A.pagemap.c;B.loadScript(D,true);},start:function(){this.init();
},run:function(){if(this.version!==this.config.version){return;}if(this.chooseInvitation()){if(this.invitation.config.isRapidCookie){if(A.config.cookie.rapidDuration){A.config.cookie.duration=A.config.cookie.rapidDuration;
}}if(this.writeAlreadyAsked()){this.invitation.render();}else{return;}}else{var D={};
D.timestamp=-1;D.cookiename=A.config.cookie.name;D.options=A.config.cookie;B.UserPersistence.setUserObj(D);
}},validateEmailAddress:function(D){return(D.indexOf(".")>2)&&(D.indexOf("@")>0);
},addSurveyParam:function(D,F){var E=C.Builder.invitation.config.acceptParams;if(!E.raw){E.raw="";
}F=F||"";E.raw+="&"+D+"="+escape(F);},createInvitationClass:function(E){var D="",F=A.config.prefixUrl;
if(F){D=F;}switch(E.methodology){case C.Invitation.METHODOLOGY.STANDARD:return new C.Invitation.Standard(E);
case C.Invitation.METHODOLOGY.EMAIL:return new C.Invitation.Email(E);case C.Invitation.METHODOLOGY.DD:return new C.Invitation.DD(E);
case C.Invitation.METHODOLOGY.QINVITE:return new C.Invitation.QInvite(E);}return null;
},chooseInvitation:function(){var F=this.config.invitation,G;if(F){var H=0;for(G=F.length-1;
G>=0;G--){var E=F[G];if(E.weight>=1){H+=E.weight;}}if(H>=1){var D=B.getRandom(H);
var I=0;for(G=F.length-1;G>=0;G--){I+=F[G].weight;if(D<=I){this.invitation=this.createInvitationClass(F[G]);
return true;}}}}return false;},writeAlreadyAsked:function(){if(!C.testMode||(!A.isDDInProgress())){var E=C.CONSTANTS.COOKIE_TYPE.ALREADY_ASKED;
var D={};D.cookiename=A.config.cookie.name;D.cookieoptions=A.config.cookie;B.UserPersistence.setUserObj(D);
var F=B.UserPersistence.getUserObj(D);return(F&&F.state.name==C.CONSTANTS.STATE_NAME.IDLE);
}return true;},collectSurveyData:function(){var G=[{n:"version",v:A.config.version},{n:"frequency",v:A.pagemap.f},{n:"weight",v:this.invitation.config.weight},{n:"location",v:escape(B.location)},{n:"referrer",v:escape(document.referrer)},{n:"projectId",v:this.invitation.config.projectId},{n:"site",v:this.invitation.config.acceptParams.siteCode}];
var I=this.invitation.config.acceptParams,D,H;if(I){var E="";if(I.cookie){function J(L){var M=B.UserPersistence.get(L);
return M?M:"";}for(D=I.cookie.length-1;D>=0;D--){H=I.cookie[D];E=E.concat(H,":",getCookieValue(H));
}G.push({n:"otherCookies",v:E});}if(I.form){var F="";function K(M,L){var N=document.forms[M];
if(N){return N.elements[L]?N.elements[L].value:"";}return"";}for(D=I.form.length-1;
D>=0;D--){H=I.form[D];F=F.concat(H,":",K(I.form[D].form,H));}G.push({n:"otherVariables",v:F});
}}return G;}};})();COMSCORE.SiteRecruit.Builder.start();