

var CCE_EditorPrefix,CCE_EditorContainerPrefix,CCE_Editor=null,CCE_TitleID,CCE_ButtonsID,CCE_LicenseID,CCE_SubmitBtnID,CCE_SubmitText,CCE_CancelBtnID,CCE_MessageLabelID,CCE_CurrentAnnotation=-1,CCE_AnnotationToDelete=-1,CCE_OriginalTitle="",CCE_OriginalContent="",CCE_OriginalTags="",CCE_RemoveMouseEffectFunc=null,CCE_IsIE=document.all;function CCE_CancelAnnotation(){CCE_HideEditor(CCE_CurrentAnnotation,CCE_GetControlPrefixes(CCE_CurrentAnnotation).control)}function CCE_CheckCookies(){var cookieParts=document.cookie.split("; "),crumb="";for(var i=0;i<cookieParts.length;i++){var crumbs=cookieParts[i].split("=");if(crumbs[0]=="wbi"&&crumbs[1]!=""){document.cookie="wbi=; expires=Fri, 02-Jan-1970 00:00:00 GMT";var crumbParts=crumbs[1].split(":");if(crumbParts[0]=="edit"&&crumbParts[1]!="")CCE_EditAnnotation(crumbParts[1])}}}function CCE_DeleteAnnotation(idx){if(idx<0)return;CCE_InitEditor();if(confirm(CCI_DeleteConfirmationText)){CCE_AnnotationToDelete=idx;var deleteBtn=$get(CCE_GetControlPrefixes(CCE_AnnotationToDelete).container+"Delete");deleteBtn.disabled=true;Microsoft.Mtps.Web.WebServices.CCWebService.DeleteAnnotation(CCS_User,CCS_ContentUrl,CCE_AnnotationToDelete,CCE_DeleteAnnotationComplete,CCE_DeleteAnnotationFailure)}}function CCE_DeleteAnnotationComplete(result){var annotationElem=$get(CCE_GetControlPrefixes(CCE_AnnotationToDelete).container+"Container");annotationElem.style.display="none";CCE_AnnotationToDelete=-1}function CCE_DeleteAnnotationFailure(error){var deleteBtn=$get(CCE_GetControlPrefixes(CCE_AnnotationToDelete).container+"Delete");deleteBtn.disabled=false;CCE_ShowError(deleteBtn,error.get_message());CCE_AnnotationToDelete=-1}function CCE_EditAnnotation(idx){if(CCE_IsEditing)return;CCE_InitEditor();CCE_Editor.tooltip.hide();CCE_SubmitText=$get(CCE_SubmitBtnID).value;CCE_CurrentAnnotation=idx;if(idx!=-1){var prefixes=CCE_GetControlPrefixes(idx),annotationPrefix=prefixes.control,annotationContainerPrefix=prefixes.container,annotationElem=$get(annotationPrefix+"RadEditor"),annotationContainer=$get(annotationContainerPrefix+"EditorPanel"),bounds=Sys.UI.DomElement.getBounds(annotationElem);CCE_Editor.instance.setSize(bounds.width,Math.max(200,bounds.height));CCE_OriginalTitle=$get(annotationContainerPrefix+"HeaderTitle").innerHTML;CCE_OriginalContent=$get(annotationPrefix+"editorData").value;CCE_OriginalTags=$get(annotationPrefix+"tagEditorData").value;annotationElem.style.display="none";$get(annotationContainerPrefix+"Header").style.display="none";var historyElem=$get(annotationContainerPrefix+"HistoryContent");if(historyElem)historyElem.style.display="none";$get(annotationContainerPrefix+"TagEditor_panel").style.display="none";annotationContainer.className="CCI_Text_Edit";var annotationPanelID=annotationContainerPrefix+"Container";CCE_RemoveMouseEffectFunc=function(){CCI_Highlight(false,annotationPanelID)};var annotationPanelElem=$get(annotationPanelID);$addHandler(annotationPanelElem,"mouseover",CCE_RemoveMouseEffectFunc);annotationPanelElem.className="CCI_Container_Edit"}else{CCE_OriginalTitle="";CCE_OriginalContent="";CCE_OriginalTags=""}CCE_Editor.containerElement.style.display="";var titleElem=$get(CCE_TitleID);titleElem.value=CCE_OriginalTitle;CCE_SetEditorContent(CCE_OriginalContent);if(idx!=-1)annotationContainer.insertBefore(CCE_Editor.element,null);$get(CCE_EditorPrefix+"tagEditorTextBox").value=CCE_OriginalTags;$get(CCE_MessageLabelID).style.display="none";titleElem.style.display="";$get(CCE_ButtonsID).style.display="";$get(CCE_LicenseID).style.display="";CCE_Editor.containerElement.scrollIntoView(true);titleElem.focus();$get(CCS_AddLinkID).className="CCS_AddLinkDisabled";CCE_IsEditing=true}function CCE_GetChildElementByID(elem,id){var childCount=elem.childNodes.length;for(var i=0;i<childCount;i++){var childElem=elem.childNodes[i];if(childElem.id==id)return childElem;if(childElem.childNodes.length>0){var result=CCE_GetChildElementByID(childElem,id);if(result)return result}}return null}function CCE_GetControl(idx,name){return $get(CCE_GetControlPrefixes(idx).control+name)}function CCE_GetControlPrefixes(idx){var count=CCE_EditorInfo.length;for(var i=0;i<count;i++){var value=CCE_EditorInfo[i];if(value["i"]==idx)return {control:value["p"],container:value["c"]}}}function CCE_HideEditor(idx,annotationPrefix){if(idx!=-1){var annotationContainerPrefix=CCE_GetControlPrefixes(idx).container,annotationElem=$get(annotationPrefix+"RadEditor");CCE_Editor.containerElement.insertBefore(CCE_Editor.element,null);annotationElem.style.display="";$get(annotationContainerPrefix+"Header").style.display="";var historyElem=$get(annotationContainerPrefix+"HistoryContent");if(historyElem)historyElem.style.display="none";$get(annotationContainerPrefix+"TagEditor_panel").style.display="";var annotationContainer=$get(annotationContainerPrefix+"EditorPanel");annotationContainer.className="CCI_Text";var annotationPanelID=annotationContainerPrefix+"Container",annotationPanelElem=$get(annotationPanelID);$removeHandler(annotationPanelElem,"mouseover",CCE_RemoveMouseEffectFunc);CCE_RemoveMouseEffectFunc=null;annotationPanelElem.className="CCI_Container"}CCE_Editor.containerElement.style.display="none";$get(CCE_TitleID).style.display="none";$get(CCE_ButtonsID).style.display="none";$get(CCE_LicenseID).style.display="none";$get(CCS_AddLinkID).className="CCS_AddLink";CCE_Editor.tooltip.hide();CCE_IsEditing=false;CCE_CurrentAnnotation=-1}function CCE_Init(){var prefixes=CCE_GetControlPrefixes(-1);CCE_EditorPrefix=prefixes.control;CCE_EditorContainerPrefix=prefixes.container;CCE_TitleID=CCE_EditorPrefix+"title";CCE_ButtonsID=CCE_EditorPrefix+"panButtons";CCE_LicenseID=CCE_EditorPrefix+"licensePanel";CCE_SubmitBtnID=CCE_EditorPrefix+"Save";CCE_CancelBtnID=CCE_EditorPrefix+"Cancel";CCE_MessageLabelID=CCE_EditorPrefix+"lblMessage";window.setTimeout(CCE_CheckCookies,400)}function CCE_InitEditor(){if(CCE_Editor==null){CCE_Editor={instance:$find(CCE_EditorPrefix+"RadEditor"),tooltip:$find(CCE_EditorPrefix+"RadTooltip"),element:$get(CCE_EditorPrefix+"Container"),containerElement:$get(CCE_EditorContainerPrefix+"EditorPanel"),contentElement:$get(CCE_EditorPrefix+"RadEditorCenter")};$addHandler($get(CCE_TitleID),"keydown",function(e){if(e.keyCode==9&&e.shiftKey==false){var de=new Sys.UI.DomEvent(e);de.preventDefault();de.stopPropagation();CCE_Editor.instance.setFocus()}});$addHandler(CCE_Editor,"click",function(){CCE_Editor.instance.setFocus()})}}function CCE_OnClientCmdExecuted(sender,args){var cmdName=args.get_commandName();if(cmdName=="FormatBlock"){var val=args.get_value(),selElem=sender.getSelectedElement();if(val=="<body>"){if(selElem.tagName=="P"){selElem.removeAttribute("className");selElem.removeAttribute("class")}}else if(val.toLowerCase().indexOf("<pre")>-1){var doc=sender.get_document(),isIE=sender.isIE,pres=doc.getElementsByTagName("PRE");for(var i=0;i<pres.length;i++){var pre=pres[i];if(!isIE){if(pre.previousSibling){var br=pre.previousSibling.previousSibling;if(br&&br.tagName=="BR")br.parentNode.removeChild(br)}if(pre.nextSibling){var br=pre.nextSibling.nextSibling;if(br&&br.tagName=="BR")br.parentNode.removeChild(br)}var textNode=pre.firstChild;if(textNode&&textNode.nodeType==3&&textNode.nodeValue.startsWith("\n")){var newText=doc.createTextNode(textNode.nodeValue.trim());textNode.parentNode.replaceChild(newText,textNode)}}}}}}function OnClientCommandExecuting(editor,args){var commandName=args.get_commandName();if(commandName==="Outdent"&&typeof args._tool!="undefined"){args.set_cancel(true);editor.fire("Indent")}if(commandName==="Indent"&&typeof args._tool!="undefined"){args.set_cancel(true);editor.fire("Outdent")}}function CCE_OnClientLoad(sender,args){var editor_element=sender.get_element(),tableID=editor_element.id+"Wrapper",rows=$get(tableID).rows;rows[0].style.display="none";rows[3].style.display="none";rows[4].style.display="none";rows[5].style.display="none";var body=document.all?sender.get_document().body:sender.get_document();$telerik.addExternalHandler(body,"keydown",function(e){if(e.keyCode==9&&e.shiftKey==true){var de=new Sys.UI.DomEvent(e);de.preventDefault();de.stopPropagation();window.setTimeout(function(){$get(CCE_TitleID).focus()},0)}})}function CCE_SaveAnnotation(){var titleElem=$get(CCE_TitleID),title=titleElem.value,content=CCE_Editor.instance.get_html(false),tags=$get(CCE_EditorPrefix+"tagEditorTextBox").value;if(title.trim().length==0){CCE_ShowError(titleElem,CCE_ErrEmptyTitle);return}if(title.length>CCE_TitleMaxLen){CCE_ShowError(titleElem,CCE_ErrTitleTooLong);return}if(content.trim().length==0||CCE_Editor.instance.get_text().trim().length==0){CCE_ShowError(CCE_Editor.contentElement,CCE_ErrEmptyContent);return}if(content.length>CCE_ContentMaxLen){CCE_ShowError(CCE_Editor.contentElement.body,CCE_ErrContentTooLong);return}if((content.trim()==CCE_OriginalContent.trim()||CCE_Editor.instance.get_html(true).trim()==CCE_OriginalContent.trim())&&title.trim()==CCE_OriginalTitle.trim()&&tags.trim()==CCE_OriginalTags.trim()){CCE_ShowError(CCE_Editor.contentElement,CCE_ErrSameContent);return}var submitBtn=$get(CCE_SubmitBtnID);submitBtn.disabled=true;submitBtn.value=CCE_UpdateText+"...";$get(CCE_CancelBtnID).style.display="none";Microsoft.Mtps.Web.WebServices.CCWebService.UpdateAnnotation(CCS_User,CCS_ContentUrl,CCE_CurrentAnnotation,content,title,tags,CCT_Browse,CCT_Remove,CCE_UpdateAnnotationComplete,CCE_UpdateAnnotationFailure)}function CCE_SetHtml(target,content){if(target){var elem=document.createElement("div");if(content)elem.innerHTML=content;elem.style.display="inline";target.innerHTML="";target.appendChild(elem)}}function CCE_SetEditorContent(content){CCE_Editor.instance.set_html(content);var manager=CCE_Editor.instance.get_commandsManager();manager._clearCommandsToRedo();var length=manager.getCommandsToUndo().length;for(var i=0;i<length;i++)manager.removeCommandAt(0)}function CCE_ShowError(target,text){CCE_Editor.tooltip.set_text(text);CCE_Editor.tooltip.set_targetControl(target);window.setTimeout(function(){CCE_Editor.tooltip.show()},10)}function CCE_UpdateAnnotationComplete(result){if(CCE_CurrentAnnotation!=-1){var prefixes=CCE_GetControlPrefixes(CCE_CurrentAnnotation),annotationPrefix=prefixes.control,annotationContainerPrefix=prefixes.container,annotationElem=$get(annotationPrefix+"RadEditor");$get(annotationContainerPrefix+"HeaderTitle").innerHTML=result.Title;CCE_SetHtml(annotationElem,result.Content);$get(annotationPrefix+"editorData").value=result.Content;if(result.Tags!=null)$get(annotationPrefix+"tagEditorData").value=result.Tags;var tagEditorBody=$get(annotationContainerPrefix+"TagEditor_tags");CCE_SetHtml(tagEditorBody,result.TagsHtml)}else{var prefixes=CCE_GetControlPrefixes(-2),templateContainerPrefix=prefixes.container,templatePrefix=prefixes.control,newContainerPrefix=CCE_EditorContainerPrefix+CCE_EditorInfo.length+"_",newPrefix=CCE_EditorPrefix+CCE_EditorInfo.length+"_",newAnnotation=$get(templateContainerPrefix+"Container").cloneNode(true);newAnnotation.style.display="";var newHeaderElem=CCE_GetChildElementByID(newAnnotation,templateContainerPrefix+"Header"),newEditorElem=CCE_GetChildElementByID(newAnnotation,templateContainerPrefix+"EditorPanel"),newTagEditorElem=CCE_GetChildElementByID(newAnnotation,templateContainerPrefix+"TagEditor_panel");newAnnotation.id=newContainerPrefix+"Container";newHeaderElem.id=newContainerPrefix+"Header";newEditorElem.id=newContainerPrefix+"EditorPanel";CCE_GetChildElementByID(newEditorElem,templatePrefix+"Container").id=newPrefix+"Container";newTagEditorElem.id=newContainerPrefix+"TagEditor_panel";newTagEditorElem.className="CCT_Panel_Block";var titleElem=CCE_GetChildElementByID(newHeaderElem,templateContainerPrefix+"HeaderTitle");titleElem.id=newContainerPrefix+"HeaderTitle";titleElem.innerHTML=result.Title;var contentElem=CCE_GetChildElementByID(newEditorElem,templatePrefix+"RadEditor");CCE_SetHtml(contentElem,result.Content);contentElem.id=newPrefix+"RadEditor";contentElem.title="";var dataElem=CCE_GetChildElementByID(newAnnotation,templatePrefix+"editorData");dataElem.id=newPrefix+"editorData";dataElem.value=result.Content;var tagsElem=CCE_GetChildElementByID(newTagEditorElem,templateContainerPrefix+"TagEditor_tags");CCE_SetHtml(tagsElem,result.TagsHtml);var tagsDataElem=CCE_GetChildElementByID(newAnnotation,templatePrefix+"tagEditorData");tagsDataElem.id=newPrefix+"tagEditorData";if(result.Tags)tagsDataElem.value=result.Tags;var existinguser=$get(CCE_EditorContainerPrefix+"lnkViewProfile");if(existinguser!=null){var userLink=existinguser.cloneNode(true);userLink.className="CCI_Header_Link";var newEditInfo=CCE_GetChildElementByID(newHeaderElem,templateContainerPrefix+"EditInfo");newEditInfo.appendChild(userLink)}var editElem=CCE_GetChildElementByID(newHeaderElem,templateContainerPrefix+"Edit");$addHandler(editElem,"click",function(e){CCE_EditAnnotation(result.Index);e.stopPropagation();e.preventDefault()});$addHandler(contentElem,"dblclick",function(e){CCE_EditAnnotation(result.Index);e.stopPropagation();e.preventDefault()});CCE_GetChildElementByID(newTagEditorElem,templateContainerPrefix+"TagEditor_addTagLink").style.display="none";$get(CCE_EditorContainerPrefix+"wikiItems").appendChild(newAnnotation);CCE_EditorInfo[CCE_EditorInfo.length]={i:result.Index,p:newPrefix,c:newContainerPrefix}}CCE_HideEditor(CCE_CurrentAnnotation,CCE_GetControlPrefixes(CCE_CurrentAnnotation).control);var submitBtn=$get(CCE_SubmitBtnID);submitBtn.value=CCE_SubmitText;submitBtn.disabled=false;$get(CCE_CancelBtnID).style.display=""}function CCE_UpdateAnnotationFailure(error){var submitBtn=$get(CCE_SubmitBtnID);CCE_ShowError(submitBtn,CCE_ErrServerError);submitBtn.value=CCE_SubmitText;submitBtn.disabled=false;$get(CCE_CancelBtnID).style.display=""}function licTooltipClientShow(sender,eventArgs){var licTooltipId="RadToolTipWrapper_"+Telerik.Web.UI.RadToolTip.getCurrent()._element.id;if($get(licTooltipId).offsetLeft<0)$get(licTooltipId).style.left="0px";if(jQuery.browser.mozilla)$get(licTooltipId).style.top=$get(CCE_GetControlPrefixes(-1).control+"licensePreText").offsetTop-$get(licTooltipId).offsetHeight-16+"px"}function ErrorTooltipClientShow(sender,eventArgs){var errorTooltipId="RadToolTipWrapper_"+CCE_Editor.tooltip._element.id;if($get(errorTooltipId).offsetLeft<0)$get(errorTooltipId).style.left=CCE_Editor.element.offsetWidth/2+"px"}



var _ccs_controlId="",_ccs_containerId="",_timer;function CCS_BeginRequestHandler(sender,args){var prm=Sys.WebForms.PageRequestManager.getInstance();_ccs_controlId=args.get_postBackElement().id;if(prm.get_isInAsyncPostBack())args.set_cancel(true);var idx=_ccs_controlId.lastIndexOf("_");_ccs_containerId=_ccs_controlId.substring(0,idx+1)+"Container";var container=$get(_ccs_containerId);if(container);}function CCS_EndRequestHandler(sender,args){var prm=Sys.WebForms.PageRequestManager.getInstance();_ccs_controlId="";_ccs_containerId=""}function CCS_Scroll(){var tooltip=Telerik.Web.UI.RadToolTip.getCurrent();if(tooltip&&tooltip.isVisible())tooltip.show()}function CCS_ShowHelp(path,width,height){var top=window.screen.height/2-height/2,left=window.screen.width/2-width/2;window.open(path,"_blank","height="+height+",width="+width+",top="+top+",left="+left+",location=no,menubar=no,resizable=yes,status=no,toolbar=no,scrollbars=yes")}



var _currentannotationIndex=0,_flaggingContentBug=false,_unflaggingContentBug=false,_originatingUrl;function CCT_AddATag(url,annotationIndex){if(url!=""){document.cookie="edit="+annotationIndex;document.cookie="scroll="+annotationIndex;document.location.href=url}else{CCT_ShowTagEditorEditPanel(annotationIndex);CCT_GetControl(annotationIndex,"textbox").focus()}return false}function CCT_AddTags(annotationIndex){var value=CCT_GetControl(annotationIndex,"textbox").value;if(value!=""){_currentannotationIndex=annotationIndex;Microsoft.Mtps.Web.WebServices.CCWebService.AddTags(CCS_User,_originatingUrl,value,annotationIndex,CCT_Browse,CCT_Remove,CCT_TagEditorChangeComplete,CCT_TagEditorChangeFailure);CCT_ShowTagEditorViewPanel(annotationIndex)}else CCT_GetControl(annotationIndex,"messagePanel").innerHTML=CCT_NoTags;return false}function CCT_BrowseTag(url,annotationIndex){document.cookie="scroll="+annotationIndex;document.location.href=url;return false}function CCT_CancelAddTag(annotationIndex){CCT_ShowTagEditorViewPanel(annotationIndex);return false}function CCT_FlagContentBug(url,annotationIndex){if(url!=""){document.cookie="contentbug="+annotationIndex;document.cookie="scroll="+annotationIndex;document.location.href=url}else{_currentannotationIndex=annotationIndex;_flaggingContentBug=true;Microsoft.Mtps.Web.WebServices.CCWebService.AddTags(CCS_User,_originatingUrl,CCT_BugTag,annotationIndex,CCT_Browse,CCT_Remove,CCT_TagEditorChangeComplete,CCT_TagEditorChangeFailure)}return false}function CCT_GetAnnotationIndex(controlID){var count=CCT_Controls.length;for(var i=0;i<count;i++){var value=CCT_Controls[i],idx=controlID.indexOf(value["prefix"]);if(idx!=-1)return value["id"]}return -1}function CCT_GetControl(annotationIndex,control){var count=CCT_Controls.length;for(var i=0;i<count;i++){var value=CCT_Controls[i];if(value["id"]==annotationIndex)return $get(value["prefix"]+control)}}function CCT_GetTags(annotationIndex){var tags="",tagEditorBody=CCT_GetControl(annotationIndex,"tags");if(tagEditorBody){var childElems=tagEditorBody.children;if(childElems.length>0){if(childElems[0].tagName=="DIV")childElems=childElems[0].children;if(childElems.length>0)for(var i=0;i<childElems.length;i++){var elem=childElems[i].children[0];if(elem.tagName=="A")tags+=elem.innerHTML+" "}}}return tags}function CCT_Init(auth,originatingUrl){_originatingUrl=originatingUrl;var cookieParts=document.cookie.split("; "),crumb="";for(var i=0;i<cookieParts.length;i++){var crumbs=cookieParts[i].split("=");if(crumbs[0]=="scroll"&&crumbs[1]!="")CCT_ScrollToTagEditor(crumbs[1]);if(crumbs[0]=="edit"&&crumbs[1]!=""&&auth=="true")CCT_ShowTagEditorEditPanel(crumbs[1])}CCT_RemoveTagEditorCookie("remove");CCT_RemoveTagEditorCookie("contentbug")}function CCT_KeyDown(evt){if(evt.keyCode==13){CCT_AddTags(CCT_GetAnnotationIndex(evt.target.id));evt.preventDefault()}else if(evt.keyCode==27){CCT_CancelAddTag(CCT_GetAnnotationIndex(evt.target.id));evt.preventDefault()}else return true}function CCT_RemoveTag(tag,url,annotationIndex){if(url!=""){document.cookie="remove="+tag+":"+annotationIndex;document.cookie="scroll="+annotationIndex;document.location.href=url}else{_currentannotationIndex=annotationIndex;if(tag==CCT_BugTag)_unflaggingContentBug=true;Microsoft.Mtps.Web.WebServices.CCWebService.RemoveTag(CCS_User,_originatingUrl,tag,annotationIndex,CCT_Browse,CCT_Remove,CCT_TagEditorChangeComplete,CCT_TagEditorChangeFailure)}return false}function CCT_RemoveTagEditorCookie(name){document.cookie=name+"=; expires=Fri, 02-Jan-1970 00:00:00 GMT"}function CCT_ScrollToTagEditor(annotationIndex){var ctrl=CCT_GetControl(annotationIndex,"textbox");if(ctrl)ctrl.scrollIntoView(false);CCT_RemoveTagEditorCookie("scroll")}function CCT_ShowTagEditorEditPanel(annotationIndex){CCT_GetControl(annotationIndex,"view").style.display="none";CCT_GetControl(annotationIndex,"editPanel").style.display="";CCT_GetControl(annotationIndex,"textbox").value="";CCT_GetControl(annotationIndex,"messagePanel").innerHTML="";CCT_RemoveTagEditorCookie("edit")}function CCT_ShowTagEditorViewPanel(annotationIndex){CCT_GetControl(annotationIndex,"view").style.display="";CCT_GetControl(annotationIndex,"editPanel").style.display="none";CCT_GetControl(annotationIndex,"messagePanel").innerHTML=""}function CCT_TagEditorChangeComplete(result){var elem=document.createElement("div");elem.innerHTML=result;elem.style.display="inline";var tagEditorBody=CCT_GetControl(_currentannotationIndex,"tags");if(tagEditorBody){tagEditorBody.innerHTML="";tagEditorBody.appendChild(elem)}if(_flaggingContentBug){_flaggingContentBug=false;var flagPanel=CCT_GetControl(_currentannotationIndex,"flagAsPanel");if(flagPanel)flagPanel.style.display="none"}if(_unflaggingContentBug){_unflaggingContentBug=false;var flagPanel=CCT_GetControl(_currentannotationIndex,"flagAsPanel");if(flagPanel)flagPanel.style.display="block"}_currentannotationIndex=0}function CCT_TagEditorChangeFailure(error){CCT_GetControl(_currentannotationIndex,"messagePanel").innerHTML=CCT_Error;CCT_GetControl(_currentannotationIndex,"messagePanel").title=error.get_message();if(_flaggingContentBug)_flaggingContentBug=false;if(_unflaggingContentBug)_unflaggingContentBug=false}function CCTagResizableAreaChange(isCollapsing){resizeTagWidth()}function resizeTagWidth(){if(jQuery(".resizableArea .leftSection").length>0&&jQuery(".CCT_Panel").length>0&&jQuery.browser.msie&&jQuery.browser.version=="7.0"&&document.body.dir=="rtl")if(jQuery(".resizableArea .leftSection")[0].style.display=="none")jQuery(".CCT_Panel")[0].style.width=jQuery(".CCS_TopicTagEditor")[0].offsetWidth-10+"px";else jQuery(".CCT_Panel")[0].style.width=""}jQuery(document).ready(function(){if(jQuery(".resizableArea .leftSection").length>0&&jQuery(".CCT_Panel").length>0&&jQuery.browser.msie&&jQuery.browser.version=="7.0"&&document.body.dir=="rtl")resizeTagWidth()})



var b=window.navigator.appName;function DDFilterOn(e){try{ChangeDropDownImage(true);oMTPS_DD_PopUpDiv.style.top=oMTPS_DD_ImgArrow.height;if(oMTPS_DD_PopUpDiv.style.display!="inline"){oMTPS_DD_PopUpDiv.style.display="inline";if(document.addEventListener){document.addEventListener("click",TestForResizableAreaControl,false);window.addEventListener("resize",TestForResizableAreaControl,false)}else{document.attachEvent("onkeydown",HandleEvent,false);document.body.onclick=HideFromClick}}else setTimeout(HideThisMenu,0)}catch(err){throw err}e.cancelBubble=true;oMTPS_DD_Div.normalize();return}function RequestHideLanguagesMenu(){try{frameworksMenuTimer=window.setTimeout(function(){HideLanguagesMenu()},250);return}catch(err){throw err}return}function HideLanguagesMenu(){try{oMTPS_DD_PopUpDiv.style.display="none";frameworksMenuTimer=null;frameworksMenuVisible=false;currentSellection=GetLanguageSelection();if(currentSellection!=GetCookie("laguageSelection"))SaveLaguageSelection(currentSellection)}catch(err){throw err}return}function SaveLaguageSelection(currentSellection){var daysToExpire=60,cookieDate=new Date;cookieDate.setTime(cookieDate.getTime()+daysToExpire*24*6*3600000);expires="expires="+cookieDate.toGMTString();document.cookie="laguageSelection="+currentSellection+"; "+expires;frameworksMenuTimer=window.setTimeout(" ",250)}function GetLanguageSelection(){var result=0,cbxColl=oMTPS_DD_PopUpDiv.getElementsByTagName("input");for(var i=0;i<cbxColl.length;i++)if(cbxColl[i].checked==true)result|=GetEnumFromIndex(i);return result}function GetEnumFromIndex(index){switch(index){case 0:return 1;case 1:return 2;case 2:return 4;case 3:return 8;case 4:return 16;case 5:return 32;case 6:return 64;default:return 63}}function ResetLanguagesMenuTimer(e){try{if(frameworksMenuTimer!=null){window.clearTimeout(frameworksMenuTimer);frameworksMenuTimer=null}}catch(err){throw err}e.cancelBubble=true;oMTPS_DD_PopUpDiv.normalize();return}function HandleEvent(event){var nav=window.Event?true:false;if(nav)return NetscapeEventHandler(event);else return MicrosoftEventHandler()}function NetscapeEventHandler(e){if((e.which==13||e.which==27||e.which==84)&&e.target.type!="textarea"&&e.target.type!="submit"){setTimeout(HideThisMenu,0);document.removeEventListener("keydown",HandleEvent,false);e.cancelBubble=true;e.returnValue=false;e.cancel=true;e.preventDefault()}return}function MicrosoftEventHandler(){if((event.keyCode==13||event.keyCode==27||event.keyCode==84)&&event.srcElement.type!="textarea"&&event.srcElement.type!="submit"){event.returnValue=false;event.cancel=true;setTimeout(HideThisMenu,0);document.detachEvent("onkeydown",HandleEvent,false);event.cancelBubble=true}return}function HideFromClick(event){var objClicked=window.event.srcElement,objParent=objClicked.parentNode.parentNode;if(objParent.id!=oMTPS_DD_PopUpDiv.id&&objParent.id!=oMTPS_DD_Div.id){setTimeout(HideThisMenu,0);return}else{window.event.cancelBubble=true;return}}function TestForResizableAreaControl(e){try{if(e.type=="keydown"){if(e.which==84||e.which==13){setTimeout(HideThisMenu,0);document.removeEventListener("keydown",TestForResizableAreaControl,false);e.cancelBubble=true;return}}else if(e.type=="resize"){setTimeout(HideThisMenu,0);window.removeEventListener("resize",TestForResizableAreaControl,false);e.cancelBubble=true;return}if(e.type=="click")if(e.which==1||e.which==32){var eNode=e.target;if(eNode.id.length==0){setTimeout(HideThisMenu,0);document.removeEventListener("click",TestForResizableAreaControl,false);return false}else{var pNode=document.getElementById(eNode.id).parentNode.parentNode;if(eNode.id!=oMTPS_DD_PopUpDiv.id)if(pNode.id!=oMTPS_DD_PopUpDiv.id){setTimeout(HideThisMenu,0);document.removeEventListener("mousedown",TestForResizableAreaControl,false)}if(e.target.id==oMTPS_DD_ImgArrow.id){setTimeout(HideThisMenu,0);document.removeEventListener("mousedown",TestForResizableAreaControl,false)}if(e.target.id==oMTPS_DD_PanelLink.id){setTimeout(HideThisMenu,0);document.removeEventListener("mousedown",TestForResizableAreaControl,false)}}return}}catch(err){throw err}}function HideThisMenu(){oMTPS_DD_PopUpDiv.style.display="none";oMTPS_DD_ImgArrow.className="MTPS_DropDownImage LibC_arrow-off";document.body.onclick=null;return}function ChangeDropDownImage(boolOnOff){if(boolOnOff==true)oMTPS_DD_ImgArrow.className="MTPS_DropDownImage LibC_arrow-on";else oMTPS_DD_ImgArrow.className="MTPS_DropDownImage LibC_arrow-off"}function SetLangFilterAll(){FilterLanguageSpecificText("nu")}function SetLangFilter(CodeSnipID,isExistLangFilter){try{if(CodeSnipID!=null){ToggleLang(CodeSnipID);oServerBool=false}SetFilterText(isExistLangFilter)}catch(err){throw err}return}function ToggleLang(strThis){var langArray="";try{langArray=eval(strThis)}catch(err){return}try{for(i=0;i<langArray.length;i++){var thisCodeSnip=document.getElementById(langArray[i]);if(thisCodeSnip==null)continue;if(thisCodeSnip.style.display=="block"||thisCodeSnip.style.display=="")thisCodeSnip.style.display="none";else thisCodeSnip.style.display="block"}if(langArray.length>0){var thisCodeSnipElement=document.getElementById(langArray[0]);if(!thisCodeSnipElement==null){var thisCodeSnipParent=thisCodeSnipElement.parentNode.parentNode.parentNode.id;thisCodeSnipParent+="_h";var obj=document.getElementById(thisCodeSnipParent);if(obj!=null)if(obj.innerHTML.indexOf("minus.gif")>0)thisCodeSnipElement.parentNode.parentNode.style.display="block";else thisCodeSnipElement.parentNode.parentNode.style.display="none"}}}catch(err){throw err}return}function SetFilterText(isLangSpecTextExist){var spr=" : ";try{var intSetoMTPS_DD_PanelLinkText=0,objLastChecked=null,cbxColl=oMTPS_DD_PopUpDiv.getElementsByTagName("input");for(var i=0;i<cbxColl.length;i++)if(cbxColl[i].checked==true){intSetoMTPS_DD_PanelLinkText++;objLastChecked=cbxColl[i].value}if(intSetoMTPS_DD_PanelLinkText==0){oMTPS_DD_PanelLink.innerHTML=strConstLangFilterText+spr+strConstLangFilterNone;if(isLangSpecTextExist)FilterLanguageSpecificText("nu")}if(intSetoMTPS_DD_PanelLinkText==1){oMTPS_DD_PanelLink.innerHTML=strConstLangFilterText+spr+objLastChecked;if(isLangSpecTextExist){var devLang;switch(objLastChecked){case "Visual Basic":devLang="vb";break;case "C#":devLang="cs";break;case "c#":devLang="cs";break;case "C++":devLang="cpp";break;case "c++":devLang="cpp";break;case "JScript":devLang="cs";break;case "JSharp":devLang="cs";break;case "J#":devLang="cs";break;case "F#":devLang="nu";break;case "FS":devLang="nu";break;case "fs":devLang="nu";break;case "f#":devLang="nu";break;default:devLang="nu";break}FilterLanguageSpecificText(devLang)}}if(intSetoMTPS_DD_PanelLinkText>1){oMTPS_DD_PanelLink.innerHTML=strConstLangFilterText+spr+strConstLangFilterMulti;if(isLangSpecTextExist)FilterLanguageSpecificText("nu")}if(intSetoMTPS_DD_PanelLinkText==oMTPS_DD_PopUpDiv.childNodes.length){oMTPS_DD_PanelLink.innerHTML=strConstLangFilterText+spr+strConstLangFilterAll;if(isLangSpecTextExist)FilterLanguageSpecificText("nu")}intSetoMTPS_DD_PanelLinkText=0;objLastChecked=null}catch(err){throw err}return}function FilterLanguageSpecificText(devLang){var isIE=navigator.userAgent.toLowerCase().indexOf("msie")!=-1,oStyle;if(isIE){oStyle=document.styleSheets["LanguageSpecificTextStyle"];if(oStyle!=null){oStyle.removeRule(0);oStyle.addRule("."+devLang,"display:inline",0)}}else{oStyle=document.styleSheets;for(var i=0;i<oStyle.length;i++)if(oStyle[i].ownerNode.id=="LanguageSpecificTextStyle"){oStyle[i].deleteRule(0);oStyle[i].insertRule("."+devLang+"{display:inline}",0);break}}}function CheckDropDownClientCookie(isExistLangText){var cbxColl=oMTPS_DD_PopUpDiv.getElementsByTagName("input");for(var i=0;i<cbxColl.length;i++)if(cbxColl[i].checked!=true){var tStr=cbxColl[i].getAttribute("arrayValue");SetLangFilter(tStr,isExistLangText)}return}



if(typeof MTPS=="undefined"||!MTPS)var MTPS={};if(typeof MTPS.Controls=="undefined"||!MTPS.Controls)MTPS.Controls={};MTPS.Controls.BindExpandAllCollapsibleAreas=function(){this.applyClick=function(){if(jQuery("#ECImg").hasClass("LibC_c")){jQuery("#ECImg").addClass("LibC_o").removeClass("LibC_c");jQuery("div.CollapseRegionLink").trigger("click",true);jQuery("#ECExpand").hide();jQuery("#ECCollapse").show()}else{jQuery("#ECImg").addClass("LibC_c").removeClass("LibC_o");jQuery("div.CollapseRegionLink").trigger("click",false);jQuery("#ECCollapse").hide();jQuery("#ECExpand").show()}};if(jQuery("div.CollapseRegionLink > .LibC_o").not(jQuery("div.MTPS_CollapsibleRegion div.MTPS_CollapsibleRegion div.CollapseRegionLink > .LibC_o")).size()==0){jQuery("#ECImg").addClass("LibC_c").removeClass("LibC_o");jQuery("#ECCollapse").hide();jQuery("#ECExpand").show()}jQuery("#ECDiv").bind("click",this.applyClick)};MTPS.Controls.BindExpandAllCollapsibleAreas()



var loadedFired=false;jQuery(document).ready(function(){loadedFired=true});function EyeBrowMenuBarSetHeightById(tFlyId){var v=document.getElementById(tFlyId);EyeBrowMenuBarSetHeight(v);TFly_Reposition(v)}function EyeBrowMenuBarSetHeight(TFly){var maxHeight=200,maxWidth=275,scrollbarWidth=20,scrollbarHeight=20,baseHeight=5,baseWidth=5;if(TFly.DT.scrollHeight>maxHeight){baseWidth+=scrollbarWidth;baseHeight+=maxHeight}else baseHeight+=TFly.DT.scrollHeight;if(TFly.DT.scrollWidth>maxWidth){baseHeight+=scrollbarHeight;baseWidth+=maxWidth}else baseWidth+=TFly.DT.scrollWidth;if(baseWidth>maxWidth||baseHeight>maxHeight)TFly.DT.style.overflow="auto";TFly.DT.style.width=baseWidth+"px";TFly.DT.style.height=baseHeight+"px"}function GetEyeNodeRetrievalUrl(el){return el.attributes.getNamedItem("name").value}function FindEyeSection(el){var sections=el.getElementsByTagName("SPAN");if(sections.count==0)return null;else return sections[0]}function ExpEye(TFly){if(loadedFired==true&&TFly.request==null)if(TFly.InLoadingState==false){TFly.InLoadingState=true;TFly.request==ajaxEye(TFly)}}function ajaxEye(TFly){var el=FindEyeSection(TFly.DT);if(el==null)return;TFly.DT.style.cursor="progress";jQuery.ajax({type:"get",url:GetEyeNodeRetrievalUrl(el),success:function(msg){TFly.DT.style.overflow="auto";TFly.DT.innerHTML=msg;TFly.DT.style.cursor="default";window.setTimeout("EyeBrowMenuBarSetHeightById('"+TFly.id+"')",50);TFly.InLoadingState=false}})}



function IsPageRated(objID,labelID,text,flyoutID,btn){obj=document.getElementById(objID);if(obj.Rated){SubmitRating(RatingObjId,sendBtnId,pageTag);window.onbeforeunload=function(){if(window.onbeforeunload_autosubmit)window.onbeforeunload_autosubmit()};flyout=document.getElementById(flyoutID);TFly_Popup(flyout,false);window.setTimeout(function(){btn.disabled=true},100);contentRated=true;obj.Rated=true;var idePrefix=objID.replace("Rating1",""),rtgContainer=document.getElementById(idePrefix+"rtgContainer");obj.title=RatedTooltipText;if(rtgContainer!=null)rtgContainer.title=RatedTooltipText;var mini_rightDivId=document.getElementById(flyoutID).parentNode.id;jQuery("#"+idePrefix+"rtgContainer").appendTo("#"+mini_rightDivId);flyout.style.display="none";for(var i=1;i<=maxRating;i++){var star=document.getElementById(objID+"_Star_"+i);if(star!=null)star.title=RatedTooltipText}return true}else{label=document.getElementById(labelID);if(label.timer)window.clearTimeout(label.timer);else{label.className_=label.className;label.innerHTML_=label.innerHTML;label.className="WarningMessage";label.innerHTML=text}label.timer=window.setTimeout(function(){label.className=label.className_;label.innerHTML=label.innerHTML_;label.timer=null},3000)}return false}function GetRating(){var i=1;while(i<=maxRating){var obj;if(MtpsPageDirection=="rtl")obj=document.getElementById(RatingObjId+"_Star_"+(maxRating+1-i));else obj=document.getElementById(RatingObjId+"_Star_"+i);if(obj!=null&&obj.className.indexOf("emptyRatingStar")!=-1)break;i++}return i-1}function getComment(){var obj=document.getElementById(tbCommentsId);if(obj!=null)if(typeof obj.value!="undefined")return escapeHTML(obj.value);else return ""}function escapeHTML(str){var div=document.createElement("div"),text=document.createTextNode(str);div.appendChild(text);return div.innerHTML}function tbNavParent(navUrl){window.top.location.href=navUrl}function SubmitRating(objName,btnName,tag){try{var params="{";params+='"guestId":"'+CurUserId+'"';params+=',"contentUrl":"'+ClientURL+'"';params+=',"device":"'+Rating_Device+'"';params+=',"userIPAddress":"'+userIPAddress+'"';params+=',"userRating":"'+GetRating()+'"';params+=',"userComments":"'+getComment()+'"';params+=',"logException":"'+MTPS.Controls.MtpsRating.EnableLogException+'"';params+="}";jQuery.ajax({type:"POST",url:"/Platform/Controls/InteractiveToolbar/RatingsWebService.asmx/RateTopic",data:params,contentType:"application/json; charset=utf-8",dataType:"json",async:false,success:function(msg){},error:function(response){if(MTPS.Controls.MtpsRating.EnableLogException)LogRateClientException(response.responseText)}});contentRated=true;MTPS.Controls.MtpsRating.ConvertWaitingToFilled();var obj=$get(objName),btn=document.getElementById(btnName);if(obj&&obj.Rated&&btn){var d=new Date;d.setFullYear(d.getFullYear()+1);var CookieInfo=tag+"="+escape("xxx")+";expires="+d.toGMTString()+" path=/;";document.cookie=CookieInfo}}catch(e){if(MTPS.Controls.MtpsRating.EnableLogException)LogRateClientException(e.message)}}function LogRateClientException(errorMsg){var params="{";params+='"contentUrl":"'+ClientURL+'"';params+=',"userAgent":"'+navigator.userAgent+'"';params+=',"errorMsg":"'+errorMsg+'"';params+=',"userIPAddress":"'+userIPAddress+'"';params+="}";jQuery.ajax({type:"POST",url:"/Platform/Controls/InteractiveToolbar/RatingsWebService.asmx/LogRateClientException",data:params,contentType:"application/json; charset=utf-8",dataType:"json",success:function(msg){}})}function RegisterAutoSubmit(objName,btnName,tag){window.onbeforeunload_autosubmit=window.onbeforeunload;window.onbeforeunload=function(){if(window.onbeforeunload_autosubmit)window.onbeforeunload_autosubmit();obj=document.getElementById(objName);if(obj.Rated&&!contentRated)SubmitRating(objName,btnName,tag)}}function SubmitRateAction(eventArgument){try{var params="{";params+='"guestId":"'+CurUserId+'"';params+=',"contentUrl":"'+ClientURL+'"';params+=',"userIPAddress":"'+userIPAddress+'"';params+=',"eventArgument":"'+eventArgument+'"';params+="}";jQuery.ajax({type:"POST",url:"/Platform/Controls/InteractiveToolbar/RatingsWebService.asmx/RateAction",data:params,contentType:"application/json; charset=utf-8",dataType:"json",success:function(msg){}})}catch(e){}}function TFlyPreAnimate(TFly){TFly.status="on"}function CloseFLY(flyoutID){var TFly1=$get(flyoutID);TFly_SetVisibility(TFly1,false);document.body.focus()}



function LWVS_initViewSwitcher(){jQuery(".LWVS_Button").click(function(){jQuery(".LWVS_Window").toggle();return false});jQuery(".LWVS_SwitcherHeading").click(LWVS_hideWindow);jQuery(".LWFB_Button").click(LWVS_hideWindow)}function LWVS_hideWindow(){jQuery(".LWVS_Window").hide();return false}function SetViewCookie(view){var daysToExpire=60000,cookieDate=new Date;cookieDate.setTime(cookieDate.getTime()+daysToExpire*24*3600000);var domainString=";domain=.microsoft.com",expires=";expires="+cookieDate.toGMTString(),setval="viewkey="+view+domainString+expires+"; path=/";document.cookie=setval}



var b=window.navigator.appName,frameworksMenuVisible=false,frameworksMenuTimer=null;function InitFrameworksMenu(){SetCheckboxCookies(oMTPS_FW_PopUpDiv,true);SetFrameworksFilterLabel();memberlistHandler();return}function RequestHideFrameworksMenu(){try{frameworksMenuTimer=window.setTimeout("HideFrameworksMenu()",250);return}catch(err){throw err}return}function HideFrameworksMenu(){try{oMTPS_FW_PopUpDiv.style.display="none";ChangeFrameworksMenuImage(false);frameworksMenuTimer=null;frameworksMenuVisible=false}catch(err){throw err}return}function ResetFrameworksMenuTimer(e){try{if(frameworksMenuTimer!=null){window.clearTimeout(frameworksMenuTimer);frameworksMenuTimer=null}}catch(err){throw err}e.cancelBubble=true;oMTPS_FW_Div.normalize();return}function ShowFrameworksMenu(e){try{ResetFrameworksMenuTimer(e);if(frameworksMenuVisible){HideFrameworksMenu();return}var checkboxNodes=oMTPS_FW_PopUpDiv.getElementsByTagName("input");for(i=0;i<checkboxNodes.length;i++){var checkboxKeyword=checkboxNodes[i].getAttribute("keyword"),cookieValue=checkboxStates[checkboxKeyword];checkboxNodes[i].checked=cookieValue=="on"?true:false}ChangeFrameworksMenuImage(true);oMTPS_FW_PopUpDiv.style.top=oMTPS_FW_ImgArrow.height;oMTPS_FW_PopUpDiv.style.display="inline";frameworksMenuVisible=true}catch(err){throw err}e.cancelBubble=true;oMTPS_FW_Div.normalize();return}function ChangeFrameworksMenuImage(boolOnOff){if(boolOnOff==true)oMTPS_FW_ImgArrow.className="MTPS_DropDownImage LibC_arrow-on";else oMTPS_FW_ImgArrow.className="MTPS_DropDownImage LibC_arrow-off"}function FrameworksCheckboxOnclick(filterKeyword){try{var currCheckbox=null,checkboxNodes=oMTPS_FW_PopUpDiv.getElementsByTagName("input");for(var i=0;i<checkboxNodes.length;i++){var checkboxKeyword=checkboxNodes[i].getAttribute("keyword");if(checkboxKeyword==filterKeyword){currCheckbox=checkboxNodes[i];break}}var checkedCount=GetCheckedCount(checkboxNodes),currentValue=checkboxStates[filterKeyword],newValue=currentValue=="on"?"off":"on";if(currentValue=="on"&&checkedCount==1)newValue="on";currCheckbox.checked=newValue=="on";checkboxStates[filterKeyword]=newValue;SetCheckboxCookies(oMTPS_FW_PopUpDiv,false);SetFrameworksFilterLabel();memberlistHandler()}catch(err){throw err}return}function SetFrameworksFilterLabel(){try{var intSetoMTPS_FW_PanelLinkText=0,objLastChecked=null,cbxColl=oMTPS_FW_PopUpDiv.getElementsByTagName("input");for(var i=0;i<cbxColl.length;i++)if(IsChecked(cbxColl[i])){intSetoMTPS_FW_PanelLinkText++;objLastChecked=cbxColl[i].getAttribute("keyword")}if(intSetoMTPS_FW_PanelLinkText==cbxColl.length)oMTPS_FW_PanelLink.innerHTML=strConstFrameworksShowAll;else if(intSetoMTPS_FW_PanelLinkText>1)oMTPS_FW_PanelLink.innerHTML=strConstFrameworksMultiple;else switch(objLastChecked){case "netfw":oMTPS_FW_PanelLink.innerHTML=strConstFrameworksNetfwOnly;break;case "netcfw":oMTPS_FW_PanelLink.innerHTML=strConstFrameworksNetcfwOnly;break;case "xnafw":oMTPS_FW_PanelLink.innerHTML=strConstFrameworksXnafwOnly;break}}catch(err){throw err}return}



var b=window.navigator.appName,membersMenuTimer=null,checkboxStates=null,membersMenuVisible=false;function InitMembersMenu(){SetCheckboxCookies(oMTPS_MB_PopUpDiv,true);SetMemberFilterLabel();memberlistHandler();return}function RequestHideMembersMenu(){try{membersMenuTimer=window.setTimeout("HideMembersMenu()",250);return}catch(err){throw err}return}function HideMembersMenu(){try{oMTPS_MB_PopUpDiv.style.display="none";oMTPS_MB_ImgArrow.className="MTPS_DropDownImage LibC_arrow-off";membersMenuTimer=null;membersMenuVisible=false}catch(err){throw err}return}function ResetMembersMenuTimer(e){try{if(membersMenuTimer!=null){window.clearTimeout(membersMenuTimer);membersMenuTimer=null}}catch(err){throw err}e.cancelBubble=true;oMTPS_MB_Div.normalize();return}function ShowMembersMenu(e){try{ResetMembersMenuTimer(e);if(membersMenuVisible){HideMembersMenu();return}ChangeMemberDropDownImage(true);oMTPS_MB_PopUpDiv.style.top=oMTPS_MB_ImgArrow.height;oMTPS_MB_PopUpDiv.style.display="inline";membersMenuVisible=true}catch(err){throw err}e.cancelBubble=true;oMTPS_MB_Div.normalize();return}function ChangeMemberDropDownImage(boolOnOff){if(boolOnOff==true)oMTPS_MB_ImgArrow.className="MTPS_DropDownImage LibC_arrow-on";else oMTPS_MB_ImgArrow.className="MTPS_DropDownImage LibC_arrow-off"}function MembersCheckboxOnclick(filterKeyword){try{var currCheckbox=null,checkboxNodes=oMTPS_MB_PopUpDiv.getElementsByTagName("input");for(var i=0;i<checkboxNodes.length;i++){var checkboxKeyword=checkboxNodes[i].getAttribute("keyword");if(checkboxKeyword==filterKeyword){currCheckbox=checkboxNodes[i];break}}var currentValue=checkboxStates[filterKeyword],newValue=currentValue=="on"?"off":"on";currCheckbox.checked=newValue=="on";checkboxStates[filterKeyword]=newValue;SetMemberFilterLabel();SetCheckboxCookies(oMTPS_MB_PopUpDiv,false);memberlistHandler()}catch(err){throw err}return}function SetMemberFilterLabel(){try{var intSetoMTPS_MB_PanelLinkText=0,checkboxNodes=oMTPS_MB_PopUpDiv.getElementsByTagName("input");for(var i=0;i<checkboxNodes.length;i++)if(IsChecked(checkboxNodes[i]))intSetoMTPS_MB_PanelLinkText++;if(intSetoMTPS_MB_PanelLinkText==checkboxNodes.length)oMTPS_MB_PanelLink.innerHTML=strConstMembersShowAll;else oMTPS_MB_PanelLink.innerHTML=strConstMembersFiltered}catch(err){throw err}return}function SetCheckboxCookies(popupDiv,initializing){if(checkboxStates==null)checkboxStates=[];var daysToExpire=60,cookieDate=new Date;cookieDate.setTime(cookieDate.getTime()+daysToExpire*24*360000);expires="expires="+cookieDate.toGMTString();if(window.navigator.cookieEnabled==true){var checkboxNodes=popupDiv.getElementsByTagName("input");for(i=0;i<checkboxNodes.length;i++){var checkboxKeyword=checkboxNodes[i].getAttribute("keyword"),cookieValue=checkboxStates[checkboxKeyword];if(initializing){var persist=checkboxNodes[i].getAttribute("persist"),initvalue=checkboxNodes[i].getAttribute("initvalue"),currCookie=GetCookie(checkboxNodes[i].id+"_"+i);if(currCookie==null||currCookie!="on"&&currCookie!="off")currCookie=initvalue;cookieValue=persist=="true"?currCookie:initvalue;checkboxNodes[i].checked=cookieValue=="on"?true:false;checkboxStates[checkboxKeyword]=cookieValue}document.cookie=checkboxNodes[i].id+"_"+i+"="+cookieValue+"; "+expires}}return}function GetCookie(sName){var aCookie=document.cookie.split("; ");for(var i=0;i<aCookie.length;i++){var aCrumb=aCookie[i].split("=");if(sName==aCrumb[0])return unescape(aCrumb[1])}return null}function memberlistHandler(){var trNodes=document.getElementsByTagName("TR");for(var i=0;i<trNodes.length;i++){var memberdata=trNodes[i].getAttribute("data");if(memberdata!=null)if(ShowBasedOnInheritance(memberdata)==false||ShowBasedOnVisibility(memberdata)==false||ShowBasedOnFramework(memberdata)==false)trNodes[i].style.display="none";else trNodes[i].style.display=""}ShowHideFrameworkImages()}function ShowHideFrameworkImages(){var allImgs=document.getElementsByTagName("img");for(var i=0;i<allImgs.length;i++){var imgdata=allImgs[i].getAttribute("data");if(imgdata!=null)if(checkboxStates[imgdata]=="off")allImgs[i].style.display="none";else allImgs[i].style.display=""}}function ShowBasedOnVisibility(memberdata){var isPublic=memberdata.indexOf("public")!=-1,isProtected=memberdata.indexOf("protected")!=-1,isPrivate=memberdata.indexOf("private")!=-1,isExplicitII=memberdata.indexOf("explicit")!=-1,publicCheck=checkboxStates["Public"],showPublic=publicCheck==null?true:publicCheck=="on",protectedCheck=checkboxStates["Protected"],showProtected=protectedCheck==null?true:protectedCheck=="on";if(showProtected&&isProtected||showPublic&&isPublic||isExplicitII||isPrivate)return true;return false}function ShowBasedOnInheritance(memberdata){var isInherited=memberdata.indexOf("inherited")!=-1,isDeclared=memberdata.indexOf("declared")!=-1,inheritedCheck=checkboxStates["Inherited"],showInherited=inheritedCheck==null?true:inheritedCheck=="on",declaredCheck=checkboxStates["Declared"],showDeclared=declaredCheck==null?true:declaredCheck=="on";if(showInherited&&isInherited||showDeclared&&isDeclared)return true;return false}function ShowBasedOnFramework(memberdata){var isNetfw=memberdata.indexOf("notNetfw")==-1,isNetcfw=memberdata.indexOf("netcfw")!=-1,isXnafw=memberdata.indexOf("xnafw")!=-1,netfwCheck=checkboxStates["netfw"],netcfwCheck=checkboxStates["netcfw"],xnafwCheck=checkboxStates["xnafw"];if(netfwCheck==null&&netcfwCheck==null&&xnafwCheck==null)return true;var showNetfw=netfwCheck=="on",showNetcfw=netcfwCheck=="on",showXnafw=xnafwCheck=="on";if(isNetfw&&showNetfw||isNetcfw&&showNetcfw||isXnafw&&showXnafw)return true;return false}function IsChecked(checkbox){var checkboxKeyword=checkbox.getAttribute("keyword");return checkboxStates[checkboxKeyword]=="on"?true:false}function GetCheckedCount(checkboxNodes){var count=0;for(var i=0;i<checkboxNodes.length;i++)if(IsChecked(checkboxNodes[i]))count++;return count}



if(typeof MTPS=="undefined"||!MTPS)var MTPS={};if(typeof MTPS.Controls=="undefined"||!MTPS.Controls)MTPS.Controls={};if(typeof MTPS.Controls.MtpsRating=="undefined"||!MTPS.Controls.MtpsRating)MTPS.Controls.MtpsRating={};MTPS.Controls.MtpsRating.createMtpsRating=function(id,_starCssClass,_filledStarCssClass,_emptyStarCssClass,_waitingStarCssClass,_maxRating,_direction,_enableLogException){this.MtpsRatingSelector="#"+id;this.MtpsRating=jQuery(this.MtpsRatingSelector);this.starCssClass=_starCssClass;this.filledStarCssClass=_filledStarCssClass;this.emptyStarCssClass=_emptyStarCssClass;this.waitingStarCssClass=_waitingStarCssClass;this.readOnly=false;this.maxRatingValue=5;this.currentRating=curRating;this.keyboardEditing=false;this.tag="";this.stars=[];this.Rated=contentRated;this.EnableLogException=_enableLogException;if(this.Rated){id=id.replace("_Flyout","");document.getElementById(id+"_A").title=RatedTooltipText;this.readOnly=true}else document.getElementById(id+"_A").title=RatingTooltipText;document.getElementById(id).Rated=this.Rated;if(_direction.toLowerCase().indexOf("lefttoright")!=-1)this.ratingDirection=0;else this.ratingDirection=1;jQuery(this.MtpsRatingSelector+" a").bind("onmouseout",function(e){MTPS.Controls.MtpsRating.mouseOutHandler()});jQuery(this.MtpsRatingSelector+" span").each(function(i){if(MTPS.Controls.MtpsRating.ratingDirection==0)jQuery(this).attr("value",i+1);else jQuery(this).attr("value",MTPS.Controls.MtpsRating.maxRatingValue-i);jQuery(this).attr("title",jQuery(MTPS.Controls.MtpsRating.MtpsRatingSelector+" a").attr("title"));var v=jQuery(this).attr("value");jQuery(this).bind("mouseover",function(e){MTPS.Controls.MtpsRating.starMouseOverHandler(v)});jQuery(this).bind("click",function(e){MTPS.Controls.MtpsRating.starClickHandler(v)});Array.add(MTPS.Controls.MtpsRating.stars,this)});this.starClickHandler=function(value){if(this.readOnly||contentRated)return;var flyout=document.getElementById(RatingFlyoutID);if(flyout!=null){flyout.status=null;flyout.onPreAnimate=null;TFly_Popup(flyout,true)}this.set_Rating(value)};this.starMouseOverHandler=function(value){if(this.readOnly||this.Rated)return;this.UpdateStarCSS(value,this.filledStarCssClass)};this.mouseOutHandler=function(){if(this.readOnly||this.Rated)return;this.UpdateStarCSS(this.currentRating,this.filledStarCssClass)};this.ConvertWaitingToFilled=function(){jQuery("."+this.waitingStarCssClass).removeClass(this.waitingStarCssClass).addClass(this.filledStarCssClass)};this.UpdateStarCSS=function(value,updateStarCSS){jQuery(".ratingStar").removeClass(this.filledStarCssClass).removeClass(this.UpdateStarCSS).removeClass(this.waitingStarCssClass);for(var i=0;i<this.maxRatingValue;i++){var starElement;if(this.ratingDirection==0)starElement=this.stars[i];else starElement=this.stars[this.maxRatingValue-i-1];if(value>i)starElement.className=this.starCssClass+" "+updateStarCSS;else starElement.className=this.starCssClass+" "+this.emptyStarCssClass}};this.set_Rating=function(value){if(this.readOnly)return;this.UpdateStarCSS(value,this.waitingStarCssClass);this.Rated=true;document.getElementById(id).Rated=this.Rated};this.OnKeyPress=function(e){if(e.target.tagName.toLowerCase()=="input"||e.target.tagName.toLowerCase()=="textarea"||contentRated)return;if(e.which==9)if(!e.data.keyboardEditing){document.getElementById(id).focus();e.data.keyboardEditing=true}else{e.data.keyboardEditing=false;var commentid=jQuery("div[class='ratingFlyoutPopup'] textarea").attr("id")}if(e.which==37&&e.data.currentRating>1&&e.data.keyboardEditing){e.data.currentRating--;e.data.starClickHandler(e.data.currentRating)}if(e.which==39&&e.data.currentRating<5&&e.data.keyboardEditing){e.data.currentRating++;e.data.starClickHandler(e.data.currentRating)}e.cancelBubble=true};jQuery(this.MtpsRatingSelector).bind("keydown",this,this.OnKeyPress)}



var b=window.navigator.appName;function MTVDD_DropDownOn(e){try{MTVDD_ChangeImage(true);MTVDD_PopUpDiv.style.top=MTVDD_ImgArrow.height;if(MTVDD_PopUpDiv.style.display!="inline"){MTVDD_PopUpDiv.style.display="inline";if(document.addEventListener){document.addEventListener("click",MTVDD_TestForResizableAreaControl,false);window.addEventListener("resize",MTVDD_TestForResizableAreaControl,false)}else{document.attachEvent("onkeydown",MTVDD_HandleEvent,false);document.body.onclick=MTVDD_HideFromClick}}else setTimeout(MTVDD_HideThisMenu,0)}catch(err){throw err}e.cancelBubble=true;MTVDD_Div.normalize();return}function MTVDD_SelectViewPreference(e,viewPreferenceCode){setTimeout(MTVDD_HideThisMenu,0);MTVDD_SetViewPreference(viewPreferenceCode);MTVDD_SaveViewPreference(viewPreferenceCode);window.location.reload();e.returnValue=false}function MTVDD_SetViewPreference(viewPreferenceCode){MTVDD_CurrentViewPreference=viewPreferenceCode;var opt=document.getElementById("MtViewDropDownOption"+viewPreferenceCode.toString());MTVDD_PanelLink.innerHTML=MTVDD_DropDownLabel+" "+opt.innerHTML;MTVDD_PanelLink.title=opt.title}function MTVDD_HandleEvent(event){var nav=window.Event?true:false;if(nav)return MTVDD_NetscapeEventHandler(event);else return MTVDD_MicrosoftEventHandler()}function MTVDD_NetscapeEventHandler(e){if((e.which==13||e.which==27||e.which==84)&&e.target.type!="textarea"&&e.target.type!="submit"){setTimeout(MTVDD_HideThisMenu,0);document.removeEventListener("keydown",MTVDD_HandleEvent,false);e.cancelBubble=true;e.returnValue=false;e.cancel=true;e.preventDefault()}return}function MTVDD_MicrosoftEventHandler(){if((event.keyCode==13||event.keyCode==27||event.keyCode==84)&&event.srcElement.type!="textarea"&&event.srcElement.type!="submit"){event.returnValue=false;event.cancel=true;setTimeout(MTVDD_HideThisMenu,0);document.detachEvent("onkeydown",MTVDD_HandleEvent,false);event.cancelBubble=true}return}function MTVDD_HideFromClick(event){var objClicked=window.event.srcElement,objParent=objClicked.parentNode.parentNode;if(objParent.id!=MTVDD_PopUpDiv.id&&objParent.id!=MTVDD_Div.id){setTimeout(MTVDD_HideThisMenu,0);return}else{window.event.cancelBubble=true;return}}function MTVDD_TestForResizableAreaControl(e){try{if(e.type=="keydown"){if(e.which==84||e.which==13){setTimeout(MTVDD_HideThisMenu,0);document.removeEventListener("keydown",MTVDD_TestForResizableAreaControl,false);e.cancelBubble=true;return}}else if(e.type=="resize"){setTimeout(MTVDD_HideThisMenu,0);window.removeEventListener("resize",MTVDD_TestForResizableAreaControl,false);e.cancelBubble=true;return}if(e.type=="click")if(e.which==1||e.which==32){var eNode=e.target;if(eNode.id.length==0){setTimeout(MTVDD_HideThisMenu,0);document.removeEventListener("click",MTVDD_TestForResizableAreaControl,false);return false}else{var pNode=document.getElementById(eNode.id).parentNode.parentNode;if(eNode.id!=MTVDD_PopUpDiv.id)if(pNode.id!=MTVDD_PopUpDiv.id){setTimeout(MTVDD_HideThisMenu,0);document.removeEventListener("mousedown",MTVDD_TestForResizableAreaControl,false)}if(e.target.id==MTVDD_ImgArrow.id){setTimeout(MTVDD_HideThisMenu,0);document.removeEventListener("mousedown",MTVDD_TestForResizableAreaControl,false)}if(e.target.id==MTVDD_PanelLink.id){setTimeout(MTVDD_HideThisMenu,0);document.removeEventListener("mousedown",MTVDD_TestForResizableAreaControl,false)}}return}}catch(err){throw err}}function MTVDD_HideThisMenu(){MTVDD_PopUpDiv.style.display="none";MTVDD_ImgArrow.src=MTVDD_ArrowOffPath;document.body.onclick=null;return}function MTVDD_ChangeImage(boolOnOff){if(boolOnOff==true)MTVDD_ImgArrow.src=MTVDD_ArrowOnPath;else MTVDD_ImgArrow.src=MTVDD_ArrowOffPath}function MTVDD_SaveViewPreference(viewPreferenceCode){if(window.navigator.cookieEnabled==true){var daysToExpire=60,cookieDate=new Date;cookieDate.setTime(cookieDate.getTime()+daysToExpire*24*360000);document.cookie="MtViewPreference="+viewPreferenceCode.toString()+"; expires="+cookieDate.toGMTString()}}



function jsTrim(s){return s.replace(/(^\s+)|(\s+$)/g,"")}function Track(trackParm,objLink){var daysToExpire=60,cookieDate=new Date;cookieDate.setTime(cookieDate.getTime()+daysToExpire*24*2160000000);expires="expires="+cookieDate.toGMTString();if(typeof pageShortId!=="undefined"&&objLink.hash)document.cookie="InstrumentedLinkAnchorHashCookie="+pageShortId+":"+objLink.hash.replace("#","")+"; "+expires;if(objLink.innerText&&jsTrim(objLink.innerText))LinkText=objLink.innerText;else if(objLink.all&&objLink.all(0).alt)LinkText=objLink.all(0).alt;var strDomain=document.domain,s=trackParm.split("|"),strLinkArea,strLinkId,strPageRegion;if(trackParm.substring(0,1)=="|"){strPageRegion=s[1];strLinkArea=s[2];strLinkId=s[2]+s[3]}else{strLinkArea=s[0];strLinkId=s[0]+s[1]}if(typeof LinkText=="undefined"||!LinkText||LinkText=="")LinkText=strLinkId;ctUrl=objLink.href+"?LinkId="+strLinkId+"&LinkArea="+strLinkArea;if(typeof DCSext!="undefined"){DCSext.wt_strHeadlnLocale=detectedLocale;DCSext.wt_strCat=strLinkArea+"|"+detectedLocale;DCSext.wt_strUrl=window.location.href.toLowerCase();DCSext.wt_strArea=strPageRegion}return false}



if(typeof MTPS=="undefined"||!MTPS)var MTPS={};if(typeof MTPS.Controls=="undefined"||!MTPS.Controls)MTPS.Controls={};MTPS.Controls.CreateResizeableArea=function(resizeableareaid,splitterid,leftid,rightid,TOCWidthCookieName,TOCIsCollapsedCookieName,IE6Offset){this.ResizeableAreaselector="#"+resizeableareaid;this.ResizeableArea=jQuery(this.ResizeableAreaselector).get(0);this.leftselector="#"+leftid;this.leftSection=jQuery(this.leftselector).get(0);this.splitterselector="#"+splitterid;this.splitter=jQuery(this.splitterselector).get(0);this.rightselector="#"+rightid;this.rightSection=jQuery(this.rightselector).get(0);this.CollapsedCookieName=TOCIsCollapsedCookieName;this.WidthCookieName=TOCWidthCookieName;this.ie6Offset=IE6Offset;this.useParentOffsetHeight=!(this.ResizeableArea.parentNode.offsetHeight==document.documentElement.clientHeight);this.minWidth=30;this.rightSectionMinWidth=200;this.dragging=false;this.ToggleEvent=function(iscurrentlyCollapsed){if(iscurrentlyCollapsed&&this.leftSection.style.display=="block"||!iscurrentlyCollapsed&&this.leftSection.style.display=="none")if(this.ClientCollapseEvents)this.ClientCollapseEvents(!iscurrentlyCollapsed)};this.Redraw=function(width){var date=new Date;date.setYear(date.getFullYear()+1);if(width<=this.minWidth){this.leftSection.style.display="none";document.cookie=this.CollapsedCookieName+"=true; expires="+date.toGMTString();+"; path=/";this.splitter.style.left="0px"}else{this.leftSection.style.display="block";this.splitter.style.left=width+"px";this.leftSection.style.width=width+"px";document.cookie=this.CollapsedCookieName+"=false; expires="+date.toGMTString();+"; path=/";document.cookie=this.WidthCookieName+"="+width+"; expires="+date.toGMTString();+"; path=/"}if(jQuery.browser.msie){var ver=parseInt(jQuery.browser.version);if(ver!=NaN&&ver==6)jQuery(window).trigger("resize",this)}};this.isCurrentlyCollapsed=function(){return jQuery(this.leftselector).css("display")=="none"};this.OpenCollapse=function(open){var currentCollapseState=this.isCurrentlyCollapsed();if(open!=undefined&&open!=currentCollapseState)return;if(this.leftSection.style.display=="none")this.Redraw(parseInt(jQuery(this.leftselector).width()));else this.Redraw(0);this.ToggleEvent(currentCollapseState)};this.OnDoubleClick=function(e){e.data.OpenCollapse()};this.OnKeyPress=function(e){if(e.which==116&&e.target.tagName.toLowerCase()!="input"&&e.target.tagName.toLowerCase()!="textarea")e.data.OpenCollapse();e.cancelBubble=true};this.resizeStart=function(e){e.data.dragging=true;var i=e.data.GetX(e.data.splitter.parentNode)+e.clientX-e.data.GetX(e.data.splitter);e.data.splitter.parentOffsetX=i;jQuery(document).bind("mousemove",e.data,e.data.mouseMove);jQuery(document).bind("mouseup",e.data,e.data.resizeStop);document.body.ondrag=function(){return !e.data.dragging};document.body.onselectstart=function(){return !e.data.dragging};return false};this.resizeStop=function(e){jQuery(document).unbind("mousemove",e.data.mouseMove);jQuery(document).unbind(e);var iscurrentlyCollapsed=e.data.leftSection.style.display=="none";e.data.Redraw(e.data.splitter.offsetLeft);e.data.dragging=false;e.data.ToggleEvent(iscurrentlyCollapsed)};this.GetX=function(oElement){var x=0;while(oElement!=null){x+=oElement.offsetLeft;oElement=oElement.offsetParent}return x};this.mouseMove=function(e){x=e.clientX-e.data.splitter.parentOffsetX;if(x<=e.data.minWidth)x=0;else if(x>=e.data.splitter.parentNode.offsetWidth-e.data.splitter.offsetWidth-e.data.rightSectionMinWidth)x=e.data.splitter.parentNode.offsetWidth-e.data.splitter.offsetWidth-e.data.rightSectionMinWidth;e.data.splitter.style.left=x+"px";return false};this.IE6Only=function(e){while(e.data.rightSection.offsetWidth!=e.data.ResizeableArea.offsetWidth-e.data.splitter.offsetWidth-e.data.leftSection.offsetWidth-6)e.data.rightSection.style.width=e.data.ResizeableArea.offsetWidth-e.data.splitter.offsetWidth-e.data.leftSection.offsetWidth-6+"px";e.data.ResizeableArea.style.height=document.documentElement.clientHeight-e.data.ie6Offset};this.IE7Only=function(e){if(e.data.useParentOffsetHeight)e.data.ResizeableArea.style.height=e.data.ResizeableArea.parentNode.offsetHeight;else e.data.ResizeableArea.style.height=document.documentElement.clientHeight};this.InitDisplay=function(){this.rightSection.style.width=document.body.clientWidth-4-this.leftSection.offsetWidth-4+"px"};jQuery(this.splitterselector).bind("mousedown",this,this.resizeStart);jQuery(document).bind("keypress",this,this.OnKeyPress);jQuery(this.splitterselector).bind("dblclick",this,this.OnDoubleClick);if(jQuery.browser.msie){var ver=parseInt(jQuery.browser.version);if(ver!=NaN&&ver>7)return;if(ver!=NaN&&ver==6){jQuery(window).bind("resize",this,this.IE6Only);this.InitDisplay()}else if(ver!=NaN&&ver>=7)jQuery(window).bind("resize",this,this.IE7Only);jQuery(window).trigger("resize",this)}return this}



function dolivesearch(sender){var o=document.getElementById(sender);if(o.className=="TextBoxSearch")document.getElementById("go").value="false";else{document.getElementById("go").value="true";if(typeof dcsMultiTrack=="function"){var dcsuri,dcssip,ti;dcsuri="results.aspx";dcssip="search.live.com";ti="_STO_SearchButton: Web";dcsMultiTrack("DCS.dcsuri",dcsuri,"DCS.dcssip",dcssip,"WT.ti",ti,"WT.dl","2","WT.z_srch_t","","DCS.dcsqry","","WT.ad","","WT.mc_id","");DCS.dcsuri=DCS.dcssip=DCS.dcsqry=WT.ti=WT.z_srch_t=""}}}



function tabs_onFocusSearch(sender){if(sender.isActive)return;sender.originalValue=sender.value;sender.value="";sender.className="TabStrip_SearchBoxActive";sender.isActive=true}function tabs_onBlurSearch(sender){if(sender.value.trim()==""){sender.value=sender.originalValue;sender.className="TabStrip_SearchBox";sender.isActive=false}}



function TFly_Init(name,offsetLeft,offsetTop,alignment,anyIter,anyTime,staticHover,popupHover,popupLatency,hideLatency,onInit,onPreAnimate,onPopup,onHide){var TFly=document.getElementById(name);TFly.alignment=alignment;TFly.DT=document.getElementById(name+"_Popup");TFly.F=document.getElementById(name+"_Anim");TFly.S=TFly.firstChild;TFly.oX=offsetLeft;TFly.oY=offsetTop;TFly.AnyIter=anyIter;TFly.AnyTime=anyTime;TFly.popupLatency=popupLatency;TFly.hideLatency=hideLatency;TFly.onPopup=onPopup;TFly.onPreAnimate=onPreAnimate;TFly.onHide=onHide;TFly.IsHover=false;TFly.InLoadingState=false;TFly.className_=TFly.className;TFly.DT.className_=TFly.DT.className;TFly.onmouseover=function(){TFly.IsHover=true;if(staticHover!="")TFly.className=staticHover;TFly_Popup(TFly,true)};TFly.onmouseout=function(){if(staticHover!="")TFly.className=TFly.className_;TFly_Popup(TFly,false);TFly.DT.blur();TFly.IsHover=false};if(document.all){TFly.onactivate=function(){if(!TFly.IsHover)TFly.onmouseover()};TFly.ondeactivate=function(){TFly.onmouseout()}}else{TFly.onfocus=function(){TFly.onmouseover()};TFly.onblur=function(){TFly.onmouseout()}}TFly.DT.onmouseover=function(){TFly.IsHover=true;if(popupHover!="")TFly.DT.className=popupHover;TFly_Popup(TFly,true)};TFly.DT.onmouseout=function(){if(popupHover!="")TFly.DT.className=TFly.DT.className_;TFly_Popup(TFly,false);TFly.IsHover=false};TFly_CallClientFunction(onInit,TFly)}function TFly_Reposition(TFly){var clientWidth=document.body.scrollWidth-20,width=TFly.DT.offsetWidth,absX=TFly.DT.offsetLeft,d=TFly.DT;while(d=d.offsetParent)absX+=d.offsetLeft;if(clientWidth<absX+width){var diff=clientWidth-absX-width;TFly.DT.style.left=TFly.DT.offsetLeft+diff+"px"}}function TFly_CallClientFunction(name,TFly){if(name!=null&&name!="")eval(name+"(TFly);")}function TFly_SetPosition(TFly,obj){obj.style.top=TFly.oY+TFly.offsetHeight+"px";obj.style.left=TFly.oX+(TFly.offsetWidth-obj.offsetWidth)*(1+TFly.alignment)/2+"px"}function TFly_Popup(TFly,value){if(TFly.onPreAnimate)TFly_CallClientFunction(TFly.onPreAnimate,TFly);if(TFly.timer!=null)window.clearTimeout(TFly.timer);if(value){if(TFly.status=="on")return;var timeout=TFly.status=="active"?0:TFly.popupLatency;if(TFly.AnyIter>0&&TFly.AnyTime>0)TFly.timer=window.setTimeout(function(){TFly_AnimateStart(TFly,true,TFly.F.curIter)},timeout);else TFly.timer=window.setTimeout(function(){TFly_SetVisibility(TFly,true)},timeout)}else{if(TFly.status=="off")return;var timeout=TFly.status=="active"?0:TFly.hideLatency;if(TFly.AnyIter>0&&TFly.AnyTime>0)TFly.timer=window.setTimeout(function(){TFly_AnimateStart(TFly,false,TFly.F.curIter)},timeout);else TFly.timer=window.setTimeout(function(){TFly_SetVisibility(TFly,false)},timeout)}}function TFly_SetVisibility(TFly,value){if(value==true){TFly_SetPosition(TFly,TFly.DT);TFly.style.zIndex="199";TFly_Reposition(TFly);TFly.S.style.position="absolute";TFly.S.style.position="";TFly.DT.style.visibility="visible"}else{TFly.DT.style.visibility="hidden";TFly.style.zIndex="198";TFly.S.style.position="absolute";TFly.S.style.position=""}}function TFly_AnimateStart(TFly,inout,curIter){if(TFly.F.timer!=null)window.clearTimeout(TFly.F.timer);if(curIter==null)curIter=0;if(TFly.status!="active"){TFly.status="active";TFly.F.style.visibility="visible";TFly.DT.style.visibility="hidden"}if(curIter<0||curIter>TFly.AnyIter){TFly.F.curIter=curIter<1?0:TFly.AnyIter;TFly.status=TFly.F.curIter==TFly.AnyIter?"on":"off";TFly.F.style.visibility="hidden";TFly_SetPosition(TFly,TFly.DT);TFly.style.zIndex=TFly.F.curIter==TFly.AnyIter?"999":"0";if(TFly.F.curIter==TFly.AnyIter){TFly.status="on";TFly_SetVisibility(TFly,true);TFly_CallClientFunction(TFly.onPopup,TFly)}else{TFly.status="off";TFly_SetVisibility(TFly,false);TFly_CallClientFunction(TFly.onHide,TFly)}}else{var per=curIter*(95/TFly.AnyIter)+5;TFly.F.style.visibility="hidden";TFly.F.style.width=TFly.DT.offsetWidth/100*per+"px";TFly.F.style.height=TFly.DT.offsetHeight/100*per+"px";TFly_SetPosition(TFly,TFly.F);TFly.F.style.visibility="visible";var timeout=per==100?0:TFly.AnyTime-TFly.AnyTime/TFly.AnyIter*curIter;curIter+=inout?1:-1;TFly.F.timer=window.setTimeout(function(){TFly_AnimateStart(TFly,inout,curIter)},timeout);TFly.F.curIter=curIter}}







var subTocLoadCount=0,rootHolder;jQuery(document).ready(function(){LoadToc()});function LoadToc(){if(tocCollapsed=="False"&&tocLoaded==false){rootHolder=document.getElementById("tocVectorTreeId");var i=rootHolder.childNodes[0];tocLoaded=true;AsyncTocLoader()}}function GetCookie(sName){var aCookie=document.cookie.split("; ");for(var i=0;i<aCookie.length;i++){var aCrumb=aCookie[i].split("=");if(sName==aCrumb[0])return unescape(aCrumb[1])}return null}function TocResizableAreaChange(isCollapsing){if(tocCollapsed=="True"){tocCollapsed="False";LoadToc()}}function GetNextSegment(){var segment=tocVector.nodes[tocIndex].id;tocIndex++;return segment}function CreateHint(el){var tmp=el.parentNode,s="";while(tmp!=null&&tmp.tagName=="LI"){s=tmp.attributes.getNamedItem("name").value+"/"+s;tmp=tmp.parentNode;if(tmp!=null&&tmp.tagName=="UL")tmp=tmp.parentNode}return s}function WriteCookie(hint){document.cookie="TocHashCookie="+hint+"; expires=Wednesday, 01-Aug-2040 08:00:00 GMT"}function TocClick(e){if(window.event)window.event.cancelBubble=true;else e.cancelBubble=true;var srcEl=window.event?window.event.srcElement:null;if(srcEl==null&&e.target!=null)srcEl=e.target;if(srcEl.tagName=="IMG"){if(srcEl.className==emptyImg)return;if(srcEl.className==closedImg)Expand(srcEl);else Collapse(srcEl)}else if(srcEl.tagName=="A")WriteCookie(CreateHint(srcEl))}function FindHolder(container,id){var element;if(container!=null)for(x=0;x<container.childNodes.length;x++){var elementName=container.childNodes[x].attributes.getNamedItem("name").value;if(elementName!=null)if(elementName=="na"){var fhsUri=container.childNodes[x].childNodes[1].attributes.getNamedItem("href").value;if(fhsUri.indexOf(pageIdentifier)>-1)return container.childNodes[x]}else if(elementName.length>=id.length&&elementName.substr(0,id.length)==id)return container.childNodes[x]}return null}function AssembleTree(){holder=FindHolder(rootHolder,tocVector.nodes[0].id);var i,focusSet=false,length=tocVector.nodes.length;for(i=0;i<length;i++){var img=holder.childNodes[0];if(tocVector.nodes[i].resp.substr(0,4)=="<ul "){if(img!=null)img.className=openImg;var respString=tocVector.nodes[i].resp;if(tocDir==true){respString=respString.replace(/LibC_e/gi,emptyImg);respString=respString.replace(/LibC_o/gi,openImg);respString=respString.replace(/LibC_c/gi,closedImg)}holder.innerHTML=holder.innerHTML+respString;var elements=holder.getElementsByTagName("UL");holder=elements[0];if(i<length-1){var tempHolder=holder;holder=FindHolder(holder,tocVector.nodes[i+1].id);if(holder==null){SetFocus(tempHolder);focusSet=true;break}}}else{if(img!=null)img.className=emptyImg;SetFocus(holder);focusSet=true}tocVector.nodes[i].resp="done"}if(!focusSet&&holder!=null&&holder.parentNode!=null)SetFocus(holder.parentNode)}function CreateTocRequestAndInvoke(t){var segmentUri=hostbase+tocVector.nodes[t].url+".aspx";jQuery.ajax({type:"get",url:segmentUri,success:function(msg){tocVector.nodes[t].resp=msg;subTocLoadCount++;if(subTocLoadCount==tocVector.nodes.length)AssembleTree()}})}function AsyncTocLoader(){var t;for(t=0;t<tocVector.nodes.length;t++)CreateTocRequestAndInvoke(t);var segment=tocVector.nodes[tocIndex].id}function SetFocus(el){try{if(el!=null){var elements=el.getElementsByTagName("A");WriteCookie(CreateHint(elements[0]));elements[0].focus();elements[0].className="tocSelected"}FixHover()}catch(e){}}function ajaxLoader(strurl){try{return jQuery.ajax({url:strurl,async:false}).responseText}catch(e){return}}function GetNodeRetrievalUrl(el){var parent=el.parentNode;return hostbase+"/"+parent.attributes.getNamedItem("name").value+".aspx"}function FindSection(el){var parent=el.parentNode;return parent}function FindSubSection(el){var parent=el.parentNode,sections=parent.getElementsByTagName("UL");if(sections.count==0)return null;else return sections[0]}function Expand(el){var section,subsection=FindSubSection(el);if(subsection==null){var subsectionHtml=ajaxLoader(GetNodeRetrievalUrl(el));if(subsectionHtml==null||subsectionHtml.substr(0,4)!="<ul "){el.className=emptyImg;return}if(tocDir==true){subsectionHtml=subsectionHtml.replace(/LibC_e/gi,emptyImg);subsectionHtml=subsectionHtml.replace(/LibC_o/gi,openImg);subsectionHtml=subsectionHtml.replace(/LibC_c/gi,closedImg)}section=FindSection(el);section.innerHTML=section.innerHTML+subsectionHtml;var elements=section.getElementsByTagName("UL");subsection=elements[0];elements=section.getElementsByTagName("IMG");el=elements[0]}el.className=openImg;subsection.style.display="block";subsection.style.visibility="visible";FixHover()}function Collapse(el){el.className=closedImg;var subsection=FindSubSection(el);if(subsection!=null){subsection.style.display="none";subsection.style.visibility="hidden"}}function FixHover(){if(jQuery("body").attr("dir")==="rtl"&&jQuery.browser.msie&&parseInt(jQuery.browser.version)===7){jQuery(".toc li a").mouseover(function(){jQuery(window.event.toElement).addClass("tochover")});jQuery(".toc li a").mouseout(function(){jQuery(window.event.fromElement).removeClass("tochover")})}}jQuery(document).ready(function(){FixHover()})

